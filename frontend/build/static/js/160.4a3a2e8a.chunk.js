"use strict";(self.webpackChunkmy_react_app=self.webpackChunkmy_react_app||[]).push([[160],{27160:(e,t,s)=>{s.r(t),s.d(t,{default:()=>oe});var n=s(72791),i=s(37795),a=s(78914),l=s(22741),r=s(88116),o=s(94744),c=s(80184);const d="event-dashboard-config-portal";const m=function(e){var t;let{event:s,stats:a,onClose:o,onRefresh:m,orgId:u,activeTab:h}=e;const[v,g]=(0,n.useState)(!1),p=(0,n.useRef)(null);(0,n.useEffect)((()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&g(!1)};return v&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[v]);const{AtlasMain:x}=(0,r.Q)(),{addNotification:j}=(0,l.l)(),b=e=>{if(!e)return"";return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},f=(()=>{if(null===s||void 0===s||!s.start_time)return null;const e=new Date;return new Date(s.start_time)>e?"upcoming":"passed"})();return(0,c.jsxs)("div",{className:"event-dashboard-header",children:[(0,c.jsx)("div",{className:"header-background",children:(0,c.jsx)("img",{src:x,alt:""})}),(0,c.jsxs)("div",{className:"header-content",children:[(0,c.jsxs)("div",{className:"header-top",children:[(0,c.jsx)("button",{className:"close-btn",onClick:o,children:(0,c.jsx)(i.JO,{icon:"mdi:close"})}),(0,c.jsxs)("div",{className:"header-actions",ref:p,children:["edit"===h&&(0,c.jsxs)("div",{className:"header-config-toggle",children:[(0,c.jsxs)("button",{type:"button",className:"action-btn settings "+(v?"active":""),onClick:()=>g((e=>!e)),title:"Event configuration",children:[(0,c.jsx)(i.JO,{icon:"mdi:cog"}),(0,c.jsx)("span",{children:"Configuration"})]}),(0,c.jsx)("div",{className:"event-dashboard-config-panel",style:{display:v?"block":"none"},"aria-hidden":!v,children:(0,c.jsx)("div",{id:d,className:"event-dashboard-config-portal"})})]}),(0,c.jsx)("button",{className:"action-btn refresh",onClick:m,title:"Refresh",children:(0,c.jsx)(i.JO,{icon:"mdi:refresh"})}),(0,c.jsx)("button",{className:"action-btn share",onClick:async()=>{if(null===s||void 0===s||!s._id)return;const e=`${window.location.origin}/event/${s._id}`;try{await navigator.clipboard.writeText(e),j({title:"Success",message:"Event link copied to clipboard",type:"success"})}catch(t){const s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.left="-999999px",document.body.appendChild(s),s.select();try{document.execCommand("copy"),j({title:"Success",message:"Event link copied to clipboard",type:"success"})}catch(t){j({title:"Error",message:"Failed to copy link to clipboard",type:"error"})}document.body.removeChild(s)}},title:"Copy Event Link",disabled:!(null!==s&&void 0!==s&&s._id),children:(0,c.jsx)(i.JO,{icon:"mdi:share-variant"})}),(0,c.jsxs)("button",{className:"action-btn preview",onClick:()=>{if(null===s||void 0===s||!s._id)return;const e=`${window.location.origin}/event/${s._id}`;window.open(e,"_blank","noopener,noreferrer")},title:"Preview Event",disabled:!(null!==s&&void 0!==s&&s._id),children:[(0,c.jsx)(i.JO,{icon:"mdi:open-in-new"}),(0,c.jsx)("span",{children:"Preview"})]})]})]}),(0,c.jsxs)("div",{className:"header-main",children:[(0,c.jsxs)("div",{className:"event-title-section",children:[(0,c.jsx)("h1",{children:(null===s||void 0===s?void 0:s.name)||"Event"}),(0,c.jsx)("div",{className:"event-meta",children:f&&(0,c.jsx)("span",{className:`event-status-bubble ${f}`,children:"upcoming"===f?"Upcoming":"Passed"})})]}),(0,c.jsxs)("div",{className:"quick-stats",children:[(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)(i.JO,{icon:"mingcute:user-group-fill",className:"stat-icon"}),(0,c.jsxs)("div",{className:"stat-content",children:[(0,c.jsx)("span",{className:"stat-value",children:null!==(t=null===a||void 0===a?void 0:a.registrationCount)&&void 0!==t?t:0}),(0,c.jsx)("span",{className:"stat-label",children:"Registrations"})]})]}),(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock",className:"stat-icon"}),(0,c.jsxs)("div",{className:"stat-content",children:[(0,c.jsx)("span",{className:"stat-value",children:(()=>{if(null===s||void 0===s||!s.start_time)return"";const e=new Date,t=new Date(s.start_time)-e;if(t<0)return"Event has started";const n=Math.floor(t/864e5),i=Math.floor(t%864e5/36e5),a=Math.floor(t%36e5/6e4);return n>0?`${n} day${1!==n?"s":""} until event`:i>0?`${i} hour${1!==i?"s":""} until event`:`${a} minute${1!==a?"s":""} until event`})()||"N/A"}),(0,c.jsx)("span",{className:"stat-label",children:"Time Until"})]})]})]})]}),(0,c.jsxs)("div",{className:"header-details",children:[(0,c.jsxs)("div",{className:"detail-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar"}),(0,c.jsx)("span",{children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})(null===s||void 0===s?void 0:s.start_time)})]}),(0,c.jsxs)("div",{className:"detail-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),(0,c.jsxs)("span",{children:[b(null===s||void 0===s?void 0:s.start_time)," - ",b(null===s||void 0===s?void 0:s.end_time)]})]}),(0,c.jsxs)("div",{className:"detail-item",children:[(0,c.jsx)(i.JO,{icon:"fluent:location-28-filled"}),(0,c.jsx)("span",{children:(null===s||void 0===s?void 0:s.location)||"TBD"})]})]})]})]})};var u=s(43623),h=s(35967);h.kL.register(h.uw,h.f$,h.od,h.jn,h.Dx,h.u,h.De,h.Gu);const v=function(e){var t;let{eventId:s,orgId:l,expectedAttendance:r}=e;const[o,d]=(0,n.useState)(!0),m=(0,n.useRef)(null),{data:h,loading:v,error:g}=(0,a.i)(s&&l?`/org-event-management/${l}/events/${s}/rsvp-growth`:null);if((0,n.useEffect)((()=>{if(m.current&&null!==h&&void 0!==h&&h.data){const e=m.current,t=e.ctx,s=t.createLinearGradient(0,0,0,200);s.addColorStop(0,"rgba(77, 170, 87, 0.3)"),s.addColorStop(1,"rgba(77, 170, 87, 0)");const n=t.createLinearGradient(0,0,0,200);n.addColorStop(0,"rgba(33, 150, 243, 0.2)"),n.addColorStop(1,"rgba(33, 150, 243, 0)"),e.data.datasets&&e.data.datasets.length>0&&(e.data.datasets[0].backgroundColor=s,e.data.datasets[1]&&(e.data.datasets[1].backgroundColor=n)),e.update()}}),[h,o]),v)return(0,c.jsx)("div",{className:"rsvp-growth-chart",children:(0,c.jsx)("div",{className:"chart-loading",children:"Loading growth data..."})});if(g||null===h||void 0===h||!h.success)return(0,c.jsx)("div",{className:"rsvp-growth-chart",children:(0,c.jsx)("div",{className:"chart-error",children:"Error loading growth data"})});const{dailyData:p,requiredGrowth:x,targetAttendance:j,isFrozen:b}=h.data;if(!p||0===p.length)return(0,c.jsx)("div",{className:"rsvp-growth-chart",children:(0,c.jsx)("div",{className:"chart-empty",children:"No registration data available"})});const f=p.map((e=>new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))),N=o?p.map((e=>e.cumulativeRSVPs)):p.map((e=>e.dailyRSVPs)),y=o?x.map((e=>e.required)):p.map((()=>Math.round(10*h.data.requiredPerDay)/10)),k={labels:f,datasets:[{label:o?"Cumulative registrations":"Daily registrations",data:N,fill:!0,backgroundColor:"rgba(77, 170, 87, 0.1)",borderColor:"rgba(77, 170, 87, 0.8)",pointBackgroundColor:"rgba(77, 170, 87, 1)",pointBorderColor:"#fff",tension:.3,borderWidth:2,pointRadius:0,pointHoverRadius:6},{label:o?"Required Growth":"Required Daily",data:y,fill:!0,backgroundColor:"rgba(33, 150, 243, 0.1)",borderColor:"rgba(33, 150, 243, 0.6)",pointBackgroundColor:"rgba(33, 150, 243, 0.8)",pointBorderColor:"#fff",tension:0,borderWidth:2,borderDash:[5,5],pointRadius:0,pointHoverRadius:6}]},w=(null===(t=p[p.length-1])||void 0===t?void 0:t.cumulativeRSVPs)||0;return j>0&&Math.min(w/j*100,100),(0,c.jsxs)("div",{className:"rsvp-growth-chart",style:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:[(0,c.jsxs)("div",{className:"chart-header",children:[(0,c.jsxs)("div",{className:"chart-title-section",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mingcute:chart-line-fill"}),"Registration Growth"]}),b&&(0,c.jsxs)("span",{className:"frozen-badge",children:[(0,c.jsx)(i.JO,{icon:"mdi:lock"}),"Frozen"]})]}),(0,c.jsxs)("div",{className:"chart-controls",children:[(0,c.jsx)("button",{className:"toggle-btn "+(o?"active":""),onClick:()=>d(!0),children:"Cumulative"}),(0,c.jsx)("button",{className:"toggle-btn "+(o?"":"active"),onClick:()=>d(!1),children:"Daily"})]})]}),(0,c.jsx)("div",{className:"chart-container",children:(0,c.jsx)(u.x1,{ref:m,data:k,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{grid:{drawBorder:!1,display:!0,color:"rgba(0, 0, 0, 0.05)"},border:{display:!1},ticks:{color:"#666",autoSkip:f.length>15,maxTicksLimit:f.length>15?15:f.length,maxRotation:45,minRotation:0,font:{size:10,family:"Inter"},padding:8},offset:!0},y:{beginAtZero:!0,grid:{drawBorder:!1,display:!0,color:"rgba(0, 0, 0, 0.05)"},border:{display:!1},ticks:{color:"#666",font:{size:11,family:"Inter"}}}},plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,family:"Inter"},color:"#333"}},tooltip:{enabled:!0,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:12,cornerRadius:6,displayColors:!0,titleFont:{family:"Inter",size:13,weight:"bold"},bodyFont:{family:"Inter",size:12},callbacks:{title:e=>{const t=e[0].dataIndex;return f[t]},label:e=>{const t=e.parsed.y;return`${e.dataset.label}: ${Math.round(t)}`}}}}}})})]})};var g=s(86775);const p=function(e){let{event:t,stats:s,agenda:l,roles:r,equipment:o,orgId:d,onRefresh:m}=e;const[u,h]=(0,n.useState)([]),{data:p}=(0,a.i)(null!==t&&void 0!==t&&t._id&&d?`/org-event-management/${d}/events/${t._id}/roles`:null);(0,n.useEffect)((()=>{null!==p&&void 0!==p&&p.success&&h(p.data.roles||[])}),[p]);const x=(()=>{if(0===u.length)return{ready:!1,filled:0,required:0};let e=0,t=0;return u.forEach((s=>{var n;const i=s.requiredCount||0,a=(null===(n=s.assignments)||void 0===n?void 0:n.filter((e=>"confirmed"===e.status)).length)||0;e+=i,t+=a})),{ready:e>0&&t>=e,filled:t,required:e}})(),j=x.required>0?Math.round(x.filled/x.required*100):0,b=j<50,f=[{id:"agenda",label:"Agenda Published",description:null!==l&&void 0!==l&&l.isPublished?"Agenda is published and ready":"Agenda has pending changes - click Publish to make them publicly available",ready:(null===l||void 0===l?void 0:l.isPublished)||!1},{id:"jobs",label:"Jobs Filled",description:x.required>0?`${x.filled} of ${x.required} positions filled`:"No jobs defined",ready:x.ready,showProgress:x.required>0,progressData:{filled:x.filled,required:x.required,percentage:j,lowCoverage:b}},{id:"published",label:"Event Published",description:"Event is publicly visible",ready:!0}],N=f.filter((e=>e.ready)).length,y=f.length,k=(0,n.useMemo)((()=>((null===l||void 0===l?void 0:l.items)||[]).filter((e=>e.startTime&&e.endTime)).map((e=>({...e,startTime:"string"===typeof e.startTime?new Date(e.startTime):e.startTime,endTime:"string"===typeof e.endTime?new Date(e.endTime):e.endTime})))),[null===l||void 0===l?void 0:l.items]),w=k.length>0&&t;return(0,c.jsxs)("div",{className:"event-overview",children:[(0,c.jsxs)("div",{className:"overview-layout",children:[(0,c.jsx)("div",{className:"overview-left-column",children:(0,c.jsxs)("div",{className:"overview-card readiness-card",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:clipboard-check-outline"}),"Event Readiness",(0,c.jsxs)("span",{className:"readiness-count",children:[N,"/",y]})]}),(0,c.jsx)("div",{className:"readiness-list",children:f.map((e=>{var t;return(0,c.jsxs)("div",{className:`readiness-item ${e.ready?"ready":"pending"} ${null!==(t=e.progressData)&&void 0!==t&&t.lowCoverage?"low-coverage":""}`,children:[(0,c.jsx)(i.JO,{icon:e.ready?"mdi:check-circle":"mdi:alert-circle-outline"}),(0,c.jsxs)("div",{className:"readiness-content",children:[(0,c.jsxs)("div",{className:"readiness-header",children:[(0,c.jsx)("span",{className:"readiness-label",children:e.label}),e.showProgress&&e.progressData&&(0,c.jsxs)("span",{className:"readiness-stats",children:[e.progressData.filled," / ",e.progressData.required," (",e.progressData.percentage,"%)"]})]}),(0,c.jsx)("span",{className:"readiness-description",children:e.description}),e.showProgress&&e.progressData&&(0,c.jsx)("div",{className:"readiness-progress",children:(0,c.jsx)("div",{className:"readiness-progress-bar",children:(0,c.jsx)("div",{className:"readiness-progress-fill "+(e.progressData.lowCoverage?"low":""),style:{width:`${Math.min(e.progressData.percentage,100)}%`}})})})]})]},e.id)}))})]})}),(null===t||void 0===t?void 0:t._id)&&d&&(null===t||void 0===t?void 0:t.expectedAttendance)>0&&(0,c.jsx)("div",{className:"overview-right-column",children:(0,c.jsx)(v,{eventId:t._id,orgId:d,expectedAttendance:t.expectedAttendance})})]}),w&&(0,c.jsxs)("div",{className:"overview-schedule-section",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock"}),"Schedule"]}),(0,c.jsx)(g.Z,{agendaItems:k,event:t,minuteHeight:2})]})]})};var x=s(54164),j=s(8887),b=s(18633),f=s(9347),N=s(1716),y=s(84244),k=s(73516),w=s(89185);function C(e){let{room:t,isSelected:s,onToggle:n}=e;return(0,c.jsxs)("div",{className:"room-card "+(s?"selected":""),onClick:n,children:[(0,c.jsxs)("div",{className:"room-image",children:[t.image?(0,c.jsx)("img",{src:t.image,alt:t.name}):(0,c.jsx)("div",{className:"no-image",children:(0,c.jsx)(i.JO,{icon:"mdi:office-building"})}),s&&(0,c.jsx)("div",{className:"selected-badge",children:(0,c.jsx)(i.JO,{icon:"mdi:check-circle"})})]}),(0,c.jsxs)("div",{className:"room-content",children:[(0,c.jsx)("h4",{className:"room-name",children:t.name}),(0,c.jsxs)("div",{className:"room-meta",children:[t.average_rating>0&&(0,c.jsxs)("div",{className:"rating",children:[(0,c.jsx)("img",{src:k.Z,alt:"star"}),(0,c.jsx)("span",{children:t.average_rating.toFixed(1)})]}),t.capacity>0&&(0,c.jsxs)("div",{className:"capacity",children:[(0,c.jsx)(i.JO,{icon:"mdi:account-group"}),(0,c.jsx)("span",{children:t.capacity})]})]}),t.attributes&&t.attributes.length>0&&(0,c.jsxs)("div",{className:"room-attributes",children:[t.attributes.slice(0,3).map(((e,t)=>{const s=(e=>{const t=e.toLowerCase().trim();return w.Md[t]||w.jx[t]||null})(e);return(0,c.jsxs)("div",{className:"attribute-item",children:[s&&(0,c.jsx)("img",{src:s,alt:e}),(0,c.jsx)("span",{children:e})]},t)})),t.attributes.length>3&&(0,c.jsxs)("span",{className:"more-attributes",children:["+",t.attributes.length-3]})]})]})]})}const S=function(e){let{formData:t,setFormData:s,onComplete:a}=e;const{addNotification:r}=(0,l.l)(),[o,d]=(0,n.useState)([]),[m,u]=(0,n.useState)(!0),[h,v]=(0,n.useState)(new Set),[g,p]=(0,n.useState)(""),[x,j]=(0,n.useState)(""),[b,k]=(0,n.useState)([]),[w,S]=(0,n.useState)("name"),[_,I]=(0,n.useState)(!1),[E,D]=(0,n.useState)(1),[T,R]=(0,n.useState)(!0),[O,J]=(0,n.useState)(0),A=((0,n.useRef)(new Map),(0,n.useRef)(s)),$=(0,n.useRef)(a);(0,n.useEffect)((()=>{A.current=s,$.current=a}),[s,a]),(0,n.useEffect)((()=>{t.selectedRoomIds&&Array.isArray(t.selectedRoomIds)&&v(new Set(t.selectedRoomIds))}),[]),(0,n.useEffect)((()=>{if(g===x)return;const e=setTimeout((()=>{const e=x.trim(),t=g.trim();j(g),e!==t?(D(1),t?d([]):q.current=!1):t&&g!==x&&(D(1),d([]))}),300);return()=>clearTimeout(e)}),[g]);const q=(0,n.useRef)(!1),F=(0,n.useRef)(!1);(0,n.useEffect)((()=>{if(F.current)return;(async()=>{if(!(!x.trim()&&q.current&&o.length>0)){!x.trim()&&q.current&&0===o.length&&1===E&&(q.current=!1),F.current=!0,u(!0);try{if(x.trim()){const s=await(0,N.Z)("/search-rooms",null,{method:"GET",params:{query:x.trim(),limit:20,page:E}});if(s.success&&s.rooms){var e,t;const n=s.rooms.map((e=>({id:e._id,name:e.name||"Unknown Room",image:e.image||null,building:e.building||"",floor:e.floor||"",capacity:e.capacity||0,attributes:e.attributes||[],average_rating:e.average_rating||0,number_of_ratings:e.number_of_ratings||0})));d(1===E?n:e=>[...e,...n]),J((null===(e=s.pagination)||void 0===e?void 0:e.total)||n.length),R(E<((null===(t=s.pagination)||void 0===t?void 0:t.totalPages)||1))}}else if(!q.current){q.current=!0;const e=await(0,N.Z)("/top-rated-rooms",null,{method:"GET",params:{limit:10}});if(e&&e.success&&e.data){const t=e.data,s=await(0,N.Z)("/getrooms",null,{method:"GET"}),n=null!==s&&void 0!==s&&s.data?Object.keys(s.data).length:t.length;d(t),J(n),R(!1)}else{const e=await(0,N.Z)("/getrooms",null,{method:"GET"});if(e&&e.success&&e.data&&Object.keys(e.data).length>0){const t=Object.values(e.data),s=t.length,n=Math.min(20,t.length),i=t.slice(0,n);if(i.length>0){const e=await(0,N.Z)("/getbatch-new",{queries:i,exhaustive:!0});if(e&&e.success&&e.data){const t=e.data.map(((e,t)=>{if(!e||!e.room)return null;const s=e.room;return{id:i[t],name:s.name||"Unknown Room",image:s.image||null,building:s.building||"",floor:s.floor||"",capacity:s.capacity||0,attributes:s.attributes||[],average_rating:s.average_rating||0,number_of_ratings:s.number_of_ratings||0,schedule:e.data||null}})).filter(Boolean),n=t.sort(((e,t)=>{const s=e.average_rating||0,n=t.average_rating||0;return n!==s?n-s:(t.number_of_ratings||0)-(e.number_of_ratings||0)})).slice(0,10);d(n),J(s),R(!1)}}}}}}catch(s){console.error("[RoomSelectorV2] Error fetching rooms:",s),r({title:"Error",message:"Failed to load rooms. Please try again.",type:"error"})}finally{u(!1),F.current=!1}}})()}),[x,E,r]);const M=(0,n.useMemo)((()=>{const e=new Set;return o.forEach((t=>{t.attributes&&Array.isArray(t.attributes)&&t.attributes.forEach((t=>e.add(t)))})),Array.from(e).sort()}),[o]),L=(0,n.useMemo)((()=>{let e=[...o];return b.length>0&&(e=e.filter((e=>b.every((t=>{var s;return null===(s=e.attributes)||void 0===s?void 0:s.includes(t)}))))),e.sort(((e,t)=>{switch(w){case"name":return e.name.localeCompare(t.name);case"rating":return(t.average_rating||0)-(e.average_rating||0);case"capacity":return(t.capacity||0)-(e.capacity||0);default:return 0}})),e}),[o,b,w]),[P,Z]=(0,n.useState)([]);(0,n.useEffect)((()=>{(async()=>{const e=Array.from(h);if(0===e.length)return void Z([]);const t=e.map((e=>o.find((t=>t.id===e)))).filter(Boolean),s=e.filter((e=>!o.find((t=>t.id===e))));if(0!==s.length)try{const e=await(0,N.Z)("/getbatch-new",{queries:s,exhaustive:!0});if(e.success&&e.data){const n=e.data.map(((e,t)=>{if(!e.data||!e.room)return null;const n=e.room;return{id:s[t],name:n.name||"Unknown Room",image:n.image||null,building:n.building||"",floor:n.floor||"",capacity:n.capacity||0,attributes:n.attributes||[],average_rating:n.average_rating||0,number_of_ratings:n.number_of_ratings||0,schedule:e.data}})).filter(Boolean);Z([...t,...n])}else Z(t)}catch(n){console.error("Error fetching selected room details:",n),Z(t)}else Z(t)})()}),[h,o]);const U=(0,n.useRef)(null);(0,n.useEffect)((()=>{if(m)return;const e=Array.from(h),t=JSON.stringify(e.sort());if(U.current===t)return;U.current=t;const s=e.length>0?o.find((t=>t.id===e[0]))||P.find((t=>t.id===e[0])):null;A.current((t=>({...t,selectedRoomIds:e,location:(null===s||void 0===s?void 0:s.name)||null,classroomId:(null===s||void 0===s?void 0:s.id)||null,classroom_id:(null===s||void 0===s?void 0:s.id)||null}))),$.current(e.length>0)}),[h,o,P,m]);const B=(0,n.useCallback)((()=>{!m&&T&&x.trim()&&D((e=>e+1))}),[m,T,x]),z=(0,n.useCallback)((e=>{v((t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s}))}),[]),V=(0,n.useCallback)((e=>{k((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))}),[]),Q=(0,n.useRef)(null);return(0,n.useEffect)((()=>{if(!x.trim())return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&T&&!m&&B()}),{threshold:.1}),t=Q.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}}),[T,m,B,x]),(0,c.jsxs)("div",{className:"room-selector-v2",children:[(0,c.jsx)("div",{className:"info-box",children:(0,c.jsx)("p",{className:"info-text",children:g.trim()?"Search results for your query. Select one or more rooms for your event.":"Showing top 10 highest rated rooms. Search to find specific rooms by name, building, or attributes."})}),(0,c.jsxs)("div",{className:"search-filter-bar",children:[(0,c.jsxs)("div",{className:"search-input-wrapper",children:[(0,c.jsx)(i.JO,{icon:"mdi:magnify",className:"search-icon"}),(0,c.jsx)("input",{type:"text",className:"search-input",placeholder:"Search rooms...",value:g,onChange:e=>p(e.target.value)}),g&&(0,c.jsx)("button",{className:"clear-search",onClick:()=>p(""),children:(0,c.jsx)(i.JO,{icon:"mdi:close"})})]}),(0,c.jsxs)("div",{className:"filter-buttons",children:[(0,c.jsxs)("button",{className:"filter-btn "+(b.length>0?"active":""),onClick:()=>I(!0),children:[(0,c.jsx)(i.JO,{icon:"mdi:filter"}),"Filters",b.length>0&&(0,c.jsx)("span",{className:"filter-count",children:b.length})]}),(0,c.jsxs)("div",{className:"sort-dropdown",children:[(0,c.jsxs)("select",{className:"sort-select",value:w,onChange:e=>S(e.target.value),children:[(0,c.jsx)("option",{value:"name",children:"Sort by Name"}),(0,c.jsx)("option",{value:"rating",children:"Sort by Rating"}),(0,c.jsx)("option",{value:"capacity",children:"Sort by Capacity"})]}),(0,c.jsx)(i.JO,{icon:"mdi:chevron-down",className:"sort-icon"})]})]})]}),P.length>0&&(0,c.jsxs)("div",{className:"selected-section",children:[(0,c.jsxs)("h3",{children:["Selected Rooms (",P.length,")"]}),(0,c.jsx)("div",{className:"selected-grid",children:P.map((e=>(0,c.jsx)(C,{room:e,isSelected:!0,onToggle:()=>z(e.id)},e.id)))})]}),(0,c.jsx)("div",{className:"rooms-section",children:m&&0===o.length?(0,c.jsxs)("div",{className:"loading-state",children:[(0,c.jsx)(y.Z,{}),(0,c.jsx)("p",{children:"Loading rooms..."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h3",{children:0===L.length?"No rooms found":x.trim()?`Search Results (${O}${O>L.length?"+":""})`:`Top Rated Rooms (${L.length})`}),(0,c.jsx)("div",{className:"rooms-grid",children:L.map((e=>(0,c.jsx)(C,{room:e,isSelected:h.has(e.id),onToggle:()=>z(e.id)},e.id)))}),m&&o.length>0&&(0,c.jsx)("div",{className:"loading-more",children:(0,c.jsx)(y.Z,{})}),T&&!m&&(0,c.jsx)("div",{ref:Q,className:"scroll-trigger"}),!T&&o.length>0&&(0,c.jsx)("div",{className:"no-more-rooms",children:(0,c.jsx)("p",{children:"No more rooms to load"})})]})}),(0,c.jsx)(f.Z,{isOpen:_,onClose:()=>I(!1),defaultStyling:!0,children:(0,c.jsxs)("div",{className:"filter-popup-content",children:[(0,c.jsx)("h3",{children:"Filter by Attributes"}),(0,c.jsx)("div",{className:"attributes-grid",children:M.map((e=>(0,c.jsx)("button",{className:"attribute-tag "+(b.includes(e)?"selected":""),onClick:()=>V(e),children:e},e)))}),(0,c.jsxs)("div",{className:"popup-actions",children:[(0,c.jsx)("button",{className:"btn-secondary",onClick:()=>{k([]),I(!1)},children:"Clear"}),(0,c.jsx)("button",{className:"btn-primary",onClick:()=>I(!1),children:"Apply"})]})]})})]})};var _=s(87404),I=s(33329),E=s(21437),D=s(82460),T=s(93496);const R=function(e){let{formData:t,setFormData:s,onComplete:i}=e;const{addNotification:a}=(0,l.l)(),[r,o]=(0,n.useState)([]),[d,m]=(0,n.useState)(!0),[u,h]=(0,n.useState)(!1),[v,g]=(0,n.useState)(1),[p,x]=(0,n.useState)(500),[j,b]=(0,n.useState)(new Date((new Date).setDate((new Date).getDate()-(new Date).getDay()))),[f,y]=(0,n.useState)(new Date),[k,w]=(0,n.useState)((new Date).getMonth()+1),[C,S]=(0,n.useState)((new Date).getFullYear()),[R,O]=(0,n.useState)({type:"all"}),[J,A]=(0,n.useState)(!0),[$,q]=(0,n.useState)((()=>t.start_time&&t.end_time?[{id:"initial-selection",startTime:new Date(t.start_time),endTime:new Date(t.end_time),startDay:new Date(t.start_time),endDay:new Date(t.end_time),duration:(new Date(t.end_time)-new Date(t.start_time))/6e4}]:[])),F=(0,n.useRef)(null);(0,n.useRef)(!1),(0,n.useEffect)((()=>{F.current&&x(F.current.clientHeight)}),[F.current]);const M=e=>{const t={M:1,T:2,W:3,R:4,F:5},s={};return Object.keys(t).forEach((e=>{s[e]=[]})),e.forEach((e=>{var n;const i=null===(n=e.data)||void 0===n?void 0:n.weekly_schedule;i&&Object.keys(t).forEach((e=>{i[e]&&i[e].length>0&&i[e].forEach((t=>{s[e].push({start:t.start_time,end:t.end_time,class_name:t.class_name})}))}))})),Object.keys(s).forEach((e=>{s[e]=(e=>{if(0===e.length)return[];e.sort(((e,t)=>e.start-t.start));const t=[e[0]];for(let s=1;s<e.length;s++){const n=e[s],i=t[t.length-1];n.start<=i.end?i.end=Math.max(i.end,n.end):t.push(n)}return t})(s[e])})),s},L=async()=>{try{if(m(!0),!t.selectedRoomIds||0===t.selectedRoomIds.length)return a({title:"No Rooms Selected",message:"Please select rooms in the previous step",type:"error"}),o([]),void m(!1);const e=await(0,N.Z)("/getbatch-new",{queries:t.selectedRoomIds,exhaustive:!0});if(!e||!e.success||!e.data)throw new Error("Failed to fetch room schedules");const s=e.data.map(((e,s)=>{var n;const i=t.selectedRoomIds[s];return{id:i,name:(null===e||void 0===e||null===(n=e.room)||void 0===n?void 0:n.name)||`Room ${i}`,data:(null===e||void 0===e?void 0:e.data)||{},roomInfo:(null===e||void 0===e?void 0:e.room)||{}}})),n=(e=>{const t=[],s=new Date,n=new Date(s.setDate(s.getDate()-s.getDay()));for(let i=0;i<4;i++)Object.entries(e).forEach((e=>{let[s,a]=e;const l={M:1,T:2,W:3,R:4,F:5}[s];a.forEach(((e,a)=>{const r=new Date(n);r.setDate(n.getDate()+7*i+l);const o=new Date(r),c=Math.floor(e.start/60),d=e.start%60;o.setHours(c,d,0,0);const m=new Date(r),u=Math.floor(e.end/60),h=e.end%60;m.setHours(u,h,0,0),t.push({id:`blocked-${i}-${s}-${a}`,name:"Room Unavailable",type:"blocked",location:"Multiple Rooms",start_time:o,end_time:m,status:"blocked",description:"Combined unavailable time from selected rooms"})}))}));return t})(M(s));o(n),m(!1)}catch(e){console.error("Error fetching and combining room schedules:",e),a({title:"Error",message:"Failed to load room schedules",type:"error"}),m(!1)}},P=e=>{b((t=>{const s=new Date(t);return s.setDate(s.getDate()+e),s}))},Z=e=>{y((t=>{const s=new Date(t);return s.setDate(s.getDate()+e),s}))};(0,n.useEffect)((()=>{L()}),[t.selectedRoomIds]);const U=(0,n.useCallback)((e=>{if(q(e),e&&e.length>0){const t=e[0];s((e=>{var s,n;const i=new Date(t.startTime),a=new Date(t.endTime);return(null===(s=e.start_time)||void 0===s?void 0:s.getTime())===i.getTime()&&(null===(n=e.end_time)||void 0===n?void 0:n.getTime())===a.getTime()?e:{...e,start_time:i,end_time:a}}))}else s((e=>e.start_time||e.end_time?{...e,start_time:null,end_time:null}:e))}),[s]),B=(0,n.useRef)(i),z=(0,n.useRef)(null);if((0,n.useEffect)((()=>{B.current=i}),[i]),(0,n.useEffect)((()=>{const e=!(!t.start_time||!t.end_time),s=t.selectedRoomIds&&t.selectedRoomIds.length>0&&e;u||h(!0),z.current!==s&&(z.current=s,B.current(s))}),[t.start_time,t.end_time,t.selectedRoomIds,u]),d)return(0,c.jsx)("div",{className:"when-component",children:(0,c.jsx)("div",{className:"loading",children:(0,c.jsx)("p",{children:"Loading room schedules..."})})});if(!t.selectedRoomIds||0===t.selectedRoomIds.length)return(0,c.jsx)("div",{className:"when-component",children:(0,c.jsx)("div",{className:"no-rooms",children:(0,c.jsx)("p",{children:"No rooms available. Please go back and select rooms first."})})});const V=(()=>{if(0===v)return r.filter((e=>{const t=new Date(e.start_time);return t.getMonth()+1===k&&t.getFullYear()===C}));if(1===v){const e=new Date(j);return e.setDate(e.getDate()+6),e.setHours(23,59,59,999),r.filter((t=>{const s=new Date(t.start_time);return s>=j&&s<=e}))}return r.filter((e=>{const t=new Date(e.start_time),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=new Date(f.getFullYear(),f.getMonth(),f.getDate());return s.getTime()===n.getTime()}))})(),Q=(new Date).getMonth()+1,W=(new Date).getFullYear(),H=(new Date).getDate();return(0,c.jsxs)("div",{className:"when-component",children:[(0,c.jsx)("div",{className:"info-box",children:(0,c.jsxs)("div",{className:"info-content",children:[(0,c.jsx)("span",{className:"info-text",children:J?`Grey blocks show unavailable times across all selected rooms (${t.selectedRoomIds.length} rooms). Click and drag on the calendar to select your event time.`:'Click and drag on the calendar to select your event time. Toggle "Show Availability" to see room availability.'}),t.start_time&&t.end_time&&(0,c.jsxs)("div",{className:"selected-time-info",style:{marginTop:"0.5rem",fontWeight:"500"},children:["Selected: ",new Date(t.start_time).toLocaleString()," - ",new Date(t.end_time).toLocaleString()]})]})}),(0,c.jsxs)("div",{className:"calendar-wrapper",children:[(0,c.jsxs)("div",{className:"calendar-controls",children:[(0,c.jsxs)("div",{className:"calendar-navigation",children:[0===v&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>{w((e=>1===e?12:e-1)),S((e=>1===k?e-1:e))},className:"nav-button",children:"\u2190"}),(0,c.jsx)("span",{className:"date-display",children:new Date(C,k-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,c.jsx)("button",{onClick:()=>{w((e=>12===e?1:e+1)),S((e=>12===k?e+1:e))},className:"nav-button",children:"\u2192"})]}),1===v&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>P(-7),className:"nav-button",children:"\u2190"}),(0,c.jsxs)("span",{className:"date-display",children:[j.toLocaleDateString("en-US",{month:"short",day:"numeric"})," - ",new Date(j.getTime()+5184e5).toLocaleDateString("en-US",{month:"short",day:"numeric"})]}),(0,c.jsx)("button",{onClick:()=>P(7),className:"nav-button",children:"\u2192"})]}),2===v&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>Z(-1),className:"nav-button",children:"\u2190"}),(0,c.jsx)("span",{className:"date-display",children:f.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,c.jsx)("button",{onClick:()=>Z(1),className:"nav-button",children:"\u2192"})]})]}),(0,c.jsxs)("div",{className:"calendar-controls-right",children:[1===v&&(0,c.jsxs)("div",{className:"availability-toggle",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginRight:"1rem"},children:[(0,c.jsx)("label",{style:{fontSize:"0.875rem",cursor:"pointer",userSelect:"none"},onClick:()=>A(!J),children:"Show Availability"}),(0,c.jsx)(D.Z,{options:["off","on"],onChange:e=>A(1===e),selectedPass:J?1:0,setSelectedPass:e=>A(1===e)})]}),(0,c.jsx)(D.Z,{options:["month","week","day"],onChange:g,selectedPass:v,setSelectedPass:g}),(0,c.jsx)(T.Z,{options:["all","study","campus","social","club","meeting","sports"],selected:R.type,setSelected:e=>O({...R,type:e}),label:"filter"})]})]}),(0,c.jsxs)("div",{className:"calendar-content",ref:F,children:[0===v&&(0,c.jsx)(E.Z,{month:k,year:C,events:V,height:`${p}px`,currentMonth:Q,currentYear:W,currentDay:H,onWeekClick:e=>{b(new Date(e)),g(1)}}),1===v&&(0,c.jsx)(_.Z,{startOfWeek:j,events:V,height:`${p}px`,dayClick:e=>{y(new Date(e)),g(2)},autoEnableSelection:!0,selectionMode:"single",allowCrossDaySelection:!1,timeIncrement:15,singleSelectionOnly:!0,startHour:6,endHour:24,showAvailability:J,onSelectionsChange:U,initialSelections:$}),2===v&&(0,c.jsx)(I.Z,{selectedDay:f,events:V,height:`${p}px`})]})]})]})};var O=s(73234);function J(e){let{popupStep:t,popupFormData:s,setPopupFormData:n,onLocationSelected:a,onTimeSelected:l,onClose:r,onBack:o,handleClose:d}=e;const m=d||r;return(0,c.jsxs)("div",{className:"location-time-popup-content",children:[(0,c.jsxs)("div",{className:"popup-header",children:[(0,c.jsx)("h3",{children:"location"===t?"Select Location":"Select Time"}),(0,c.jsx)("button",{className:"popup-close",onClick:m,children:(0,c.jsx)(i.JO,{icon:"mdi:close"})})]}),(0,c.jsx)("div",{className:"popup-body",children:"location"===t?(0,c.jsxs)("div",{children:[(0,c.jsx)(S,{formData:s,setFormData:n,onComplete:e=>{}}),(0,c.jsxs)("div",{className:"popup-actions",children:[(0,c.jsx)("button",{className:"popup-button secondary",onClick:m,children:"Cancel"}),(0,c.jsx)("button",{className:"popup-button primary",onClick:a,disabled:(!s.selectedRoomIds||0===s.selectedRoomIds.length)&&(!s.location||!s.location.trim()),children:"Next: Select Time"})]})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)(R,{formData:s,setFormData:n,onComplete:e=>{}}),(0,c.jsxs)("div",{className:"popup-actions",children:[(0,c.jsx)("button",{className:"popup-button secondary",onClick:o,children:"Back"}),(0,c.jsx)("button",{className:"popup-button primary",onClick:l,disabled:!s.start_time||!s.end_time,children:"Confirm"})]})]})})]})}const A=function(e){var t,s;let{event:r,orgId:o,onRefresh:m}=e;const{addNotification:u}=(0,l.l)(),[h,v]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1),[y,k]=(0,n.useState)(!1),[w,C]=(0,n.useState)("location"),[S,_]=(0,n.useState)(null),I=(0,a.i)("/api/event-system-config/form-config"),{data:E,refetch:D}=(0,a.i)(o?`/org-event-management/${o}/forms`:null),T=null!==E&&void 0!==E&&E.success&&E.data||[],[R,A]=(0,n.useState)(!1),[$,q]=(0,n.useState)(null),[F,M]=(0,n.useState)({name:"",description:"",type:"",visibility:"",expectedAttendance:0,contact:"",externalLink:"",registrationEnabled:!1,registrationRequired:!1,registrationDeadline:null,registrationFormId:null,maxAttendees:null,checkInEnabled:!1,checkInMethod:"both",checkInRequireRegistration:!1,checkInAutoCheckIn:!1,checkInAllowOnPage:!0,image:null,start_time:null,end_time:null,location:"",classroom_id:null,selectedRoomIds:[]}),[L,P]=(0,n.useState)(null),[Z,U]=(0,n.useState)({selectedRoomIds:[],start_time:null,end_time:null});(0,n.useEffect)((()=>{if(r){var e,t,s,n,i,a,l,o,c,d,m;const u={name:r.name||"",description:r.description||"",type:r.type||"",visibility:r.visibility||"",expectedAttendance:r.expectedAttendance||0,contact:r.contact||"",externalLink:r.externalLink||"",registrationEnabled:null!==(e=null!==(t=r.registrationEnabled)&&void 0!==t?t:r.rsvpEnabled)&&void 0!==e&&e,registrationRequired:null!==(s=null!==(n=r.registrationRequired)&&void 0!==n?n:r.rsvpRequired)&&void 0!==s&&s,registrationDeadline:r.registrationDeadline||r.rsvpDeadline?new Date(r.registrationDeadline||r.rsvpDeadline):null,registrationFormId:r.registrationFormId||null,maxAttendees:r.maxAttendees||null,checkInEnabled:r.checkInEnabled||!1,checkInMethod:(null===(i=r.checkInSettings)||void 0===i?void 0:i.method)||"both",checkInRequireRegistration:null!==(a=null!==(l=null===(o=r.checkInSettings)||void 0===o?void 0:o.requireRegistration)&&void 0!==l?l:null===(c=r.checkInSettings)||void 0===c?void 0:c.requireRsvp)&&void 0!==a&&a,checkInAutoCheckIn:(null===(d=r.checkInSettings)||void 0===d?void 0:d.autoCheckIn)||!1,checkInAllowOnPage:!1!==(null===(m=r.checkInSettings)||void 0===m?void 0:m.allowOnPageCheckIn),image:null,start_time:r.start_time?new Date(r.start_time):null,end_time:r.end_time?new Date(r.end_time):null,location:r.location||"",classroom_id:r.classroom_id||null,selectedRoomIds:r.classroom_id?[r.classroom_id]:[]};r.customFields&&Object.keys(r.customFields).forEach((e=>{u[e]=r.customFields[e]})),M(u),P(JSON.parse(JSON.stringify(u)))}}),[r]),(0,n.useEffect)((()=>{y&&"location"===w&&U({selectedRoomIds:F.selectedRoomIds||[],location:F.location,classroom_id:F.classroom_id,start_time:F.start_time,end_time:F.end_time})}),[y,w]);const B=(e,t)=>{M((s=>({...s,[e]:t})))},z=()=>{k(!1),C("location"),_(null)},V=e=>e?new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",Q=e=>e?`${(e=>e?new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Not set")(e)} at ${V(e)}`:"Not set",W=null===(t=I.data)||void 0===t?void 0:t.data,H=(0,n.useMemo)((()=>{if(null===W||void 0===W||!W.fields)return[];const e=["name","description","type","visibility","expectedAttendance","image","start_time","end_time","location","classroom_id","selectedRoomIds","contact","externalLink","registrationEnabled","registrationRequired","registrationDeadline","registrationFormId","maxAttendees"],t=["location","date-time"];return W.fields.filter((s=>s.isActive&&!t.includes(s.step)&&!e.includes(s.name)))}),[W]);if(!r)return(0,c.jsx)("div",{className:"event-editor-tab",children:"Loading..."});const Y="undefined"!==typeof document?document.getElementById(d):null,G=(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"editor-section",children:[(0,c.jsx)("h3",{children:"Registration Settings"}),(0,c.jsxs)("div",{className:"section-content",children:[(0,c.jsx)("div",{className:"field-group",children:(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.registrationEnabled,onChange:e=>B("registrationEnabled",e.target.checked)}),(0,c.jsx)("span",{children:"Enable registration"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Registration ",F.registrationEnabled?"Enabled":"Disabled"]})})}),F.registrationEnabled&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"field-group",children:(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.registrationRequired,onChange:e=>B("registrationRequired",e.target.checked)}),(0,c.jsx)("span",{children:"Require registration"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Registration ",F.registrationRequired?"Required":"Optional"]})})}),(0,c.jsxs)("div",{className:"field-row",children:[(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Registration deadline"}),h?(0,c.jsx)("input",{type:"datetime-local",value:F.registrationDeadline?new Date(F.registrationDeadline).toISOString().slice(0,16):"",onChange:e=>B("registrationDeadline",e.target.value?new Date(e.target.value):null)}):(0,c.jsx)("div",{className:"read-only-value",children:F.registrationDeadline?Q(F.registrationDeadline):"Not set"})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Max Attendees"}),h?(0,c.jsx)("input",{type:"number",value:F.maxAttendees||"",onChange:e=>B("maxAttendees",e.target.value?parseInt(e.target.value):null),placeholder:"No limit",min:"1"}):(0,c.jsx)("div",{className:"read-only-value",children:F.maxAttendees||"No limit"})]})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Registration form"}),h?(0,c.jsxs)("div",{className:"registration-form-select-row",children:[(0,c.jsxs)("select",{value:F.registrationFormId||"",onChange:e=>B("registrationFormId",e.target.value||null),children:[(0,c.jsx)("option",{value:"",children:"None"}),T.map((e=>(0,c.jsx)("option",{value:e._id,children:e.title},e._id)))]}),(0,c.jsxs)("button",{type:"button",className:"create-form-btn",onClick:()=>{q(null),A(!0)},children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),"Create form"]}),F.registrationFormId&&(0,c.jsxs)("button",{type:"button",className:"edit-form-btn",onClick:()=>{const e=T.find((e=>e._id===F.registrationFormId));e&&q(e._id),A(!0)},children:[(0,c.jsx)(i.JO,{icon:"mdi:pencil"}),"Edit form"]})]}):(0,c.jsx)("div",{className:"read-only-value",children:F.registrationFormId&&T.length?(null===(s=T.find((e=>e._id===F.registrationFormId)))||void 0===s?void 0:s.title)||F.registrationFormId:"None"}),(0,c.jsx)("p",{className:"field-hint",children:"Optional form attendees fill out when registering."})]}),R&&(0,c.jsx)(O.Z,{orgId:o,formId:$||void 0,initialForm:$?T.find((e=>e._id===$)):void 0,onCreated:e=>{D(),!$&&e&&B("registrationFormId",e)},onClose:()=>{A(!1),q(null)}})]})]})]}),(0,c.jsxs)("div",{className:"editor-section checkin-settings-section",children:[(0,c.jsx)("h3",{children:"Check-In"}),(0,c.jsx)("p",{className:"section-description",children:"Let attendees mark that they're here using a QR code, link, or a button on the event page."}),(0,c.jsxs)("div",{className:"section-content",children:[(0,c.jsx)("div",{className:"field-group checkin-master-toggle",children:(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.checkInEnabled,onChange:e=>B("checkInEnabled",e.target.checked)}),(0,c.jsx)("span",{children:"Enable check-in for this event"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Check-in ",F.checkInEnabled?"enabled":"disabled"]})})}),F.checkInEnabled&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"checkin-subsection",children:[(0,c.jsx)("h4",{className:"subsection-title",children:"Ways to check in"}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{className:"field-label",children:"QR code & link"}),h?(0,c.jsxs)("div",{className:"radio-group",children:[(0,c.jsxs)("label",{className:"radio-label",children:[(0,c.jsx)("input",{type:"radio",name:"checkInMethod",value:"qr",checked:"qr"===F.checkInMethod,onChange:e=>B("checkInMethod",e.target.value)}),(0,c.jsx)("span",{children:"QR code only"})]}),(0,c.jsxs)("label",{className:"radio-label",children:[(0,c.jsx)("input",{type:"radio",name:"checkInMethod",value:"link",checked:"link"===F.checkInMethod,onChange:e=>B("checkInMethod",e.target.value)}),(0,c.jsx)("span",{children:"Link only"})]}),(0,c.jsxs)("label",{className:"radio-label",children:[(0,c.jsx)("input",{type:"radio",name:"checkInMethod",value:"both",checked:"both"===F.checkInMethod,onChange:e=>B("checkInMethod",e.target.value)}),(0,c.jsx)("span",{children:"Both"})]})]}):(0,c.jsx)("div",{className:"read-only-value",children:"qr"===F.checkInMethod?"QR code only":"link"===F.checkInMethod?"Link only":"Both"})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.checkInAllowOnPage,onChange:e=>B("checkInAllowOnPage",e.target.checked)}),(0,c.jsx)("span",{children:"Allow check-in from event page"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Event page check-in: ",F.checkInAllowOnPage?"Yes":"No"]})}),(0,c.jsx)("p",{className:"field-hint",children:'Show a "Check in" button on the event page (web & app) during the event.'})]})]}),(0,c.jsxs)("div",{className:"checkin-subsection",children:[(0,c.jsx)("h4",{className:"subsection-title",children:"Options"}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.checkInRequireRegistration,onChange:e=>B("checkInRequireRegistration",e.target.checked)}),(0,c.jsx)("span",{children:"Require registration to check in"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Require registration: ",F.checkInRequireRegistration?"Yes":"No"]})}),(0,c.jsx)("p",{className:"field-hint",children:"Attendees must register before they can check in."})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{className:"checkbox-label",children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"checkbox",checked:F.checkInAutoCheckIn,onChange:e=>B("checkInAutoCheckIn",e.target.checked)}),(0,c.jsx)("span",{children:"Auto check-in when using link or QR"})]}):(0,c.jsxs)("div",{className:"read-only-value",children:["Auto check-in: ",F.checkInAutoCheckIn?"On":"Off"]})}),(0,c.jsx)("p",{className:"field-hint",children:"Skip the confirmation page and check in immediately when they open the link or scan the QR."})]})]})]})]})]})]});return(0,c.jsxs)("div",{className:"event-editor-tab "+(h?"editing":"locked"),children:[(0,c.jsxs)("div",{className:"editor-header",children:[(0,c.jsx)("h2",{children:"Event Details"}),h?(0,c.jsxs)("div",{className:"editor-actions",children:[(0,c.jsx)("button",{className:"cancel-button",onClick:()=>{L&&M(JSON.parse(JSON.stringify(L))),v(!1)},disabled:g,children:"Cancel"}),(0,c.jsx)("button",{className:"save-button",onClick:async()=>{const e=(()=>{const e={};F.name&&""!==F.name.trim()||(e.name="Event name is required"),F.type||(e.type="Event type is required"),F.visibility||(e.visibility="Visibility is required"),F.start_time&&F.end_time||(e.time="Date and time are required");const t=F.selectedRoomIds&&F.selectedRoomIds.length>0,s=F.location&&""!==F.location.trim();return t||s||(e.location="Location is required (select a room or enter an address/place)"),e})();if(Object.keys(e).length>0)return console.log(e),void u({title:"Validation Error",message:"Please fix all errors before saving",type:"error"});p(!0);try{var t,s;const e={name:F.name,description:F.description,type:F.type,visibility:F.visibility,expectedAttendance:F.expectedAttendance,contact:F.contact||"",externalLink:F.externalLink||"",registrationEnabled:F.registrationEnabled,registrationRequired:F.registrationRequired,registrationDeadline:F.registrationDeadline?F.registrationDeadline.toISOString():null,registrationFormId:F.registrationFormId||null,maxAttendees:F.maxAttendees||null,checkInEnabled:F.checkInEnabled,checkInSettings:{method:F.checkInMethod,requireRegistration:F.checkInRequireRegistration,autoCheckIn:F.checkInAutoCheckIn,allowOnPageCheckIn:F.checkInAllowOnPage},start_time:F.start_time.toISOString(),end_time:F.end_time.toISOString(),classroom_id:F.classroom_id,location:F.location},n={};null!==(t=I.data)&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.fields&&I.data.data.fields.forEach((e=>{["name","description","type","visibility","expectedAttendance","contact","externalLink","registrationEnabled","registrationRequired","registrationDeadline","registrationFormId","maxAttendees","start_time","end_time","location","classroom_id","selectedRoomIds","image"].includes(e.name)||void 0!==F[e.name]&&(n[e.name]=F[e.name])})),Object.keys(n).length>0&&(e.customFields=n);const i=o?`/org-event-management/${o}/events/${r._id}`:`/update-event/${r._id}`,a=await(0,N.Z)(i,e,{method:"PUT"});if(!a.success)throw new Error(a.message||"Failed to update event");if(F.image instanceof File){const e=new FormData;e.append("image",F.image),e.append("eventId",r._id),await(0,N.Z)("/upload-event-image",e,{method:"POST"})}u({title:"Success",message:"Event updated successfully",type:"success"}),P(JSON.parse(JSON.stringify(F))),v(!1),m&&m()}catch(n){u({title:"Error",message:n.message||"Failed to update event",type:"error"})}finally{p(!1)}},disabled:g,children:g?"Saving...":"Save Changes"})]}):(0,c.jsxs)("button",{className:"edit-button",onClick:()=>{v(!0)},children:[(0,c.jsx)(i.JO,{icon:"mdi:pencil"}),"Edit"]})]}),(0,c.jsxs)("div",{className:"editor-content",children:[(0,c.jsxs)("div",{className:"editor-section",children:[(0,c.jsx)("h3",{children:"Basic Information"}),(0,c.jsxs)("div",{className:"section-content",children:[(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Event Name"}),h?(0,c.jsx)("input",{type:"text",value:F.name,onChange:e=>B("name",e.target.value),placeholder:"Event name"}):(0,c.jsx)("div",{className:"read-only-value",children:F.name||"Not set"})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Description"}),h?(0,c.jsx)("textarea",{value:F.description||"",onChange:e=>B("description",e.target.value),placeholder:"Event description",rows:4}):(0,c.jsx)("div",{className:"read-only-value",children:F.description||"Not set"})]}),(0,c.jsxs)("div",{className:"field-row",children:[(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Event Type"}),h?(0,c.jsxs)("select",{value:F.type,onChange:e=>B("type",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"Select type"}),(0,c.jsx)("option",{value:"study",children:"Study Event"}),(0,c.jsx)("option",{value:"workshop",children:"Workshop"}),(0,c.jsx)("option",{value:"campus",children:"Campus Event"}),(0,c.jsx)("option",{value:"social",children:"Social Event"}),(0,c.jsx)("option",{value:"club",children:"Club Event"}),(0,c.jsx)("option",{value:"meeting",children:"Club Meeting"}),(0,c.jsx)("option",{value:"sports",children:"Sports Event"})]}):(0,c.jsx)("div",{className:"read-only-value",children:F.type||"Not set"})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Visibility"}),h?(0,c.jsxs)("select",{value:F.visibility,onChange:e=>B("visibility",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"Select visibility"}),(0,c.jsx)("option",{value:"public",children:"Public"}),(0,c.jsx)("option",{value:"internal",children:"Internal"}),(0,c.jsx)("option",{value:"inviteOnly",children:"Invite Only"})]}):(0,c.jsx)("div",{className:"read-only-value",children:F.visibility||"Not set"})]})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Expected Attendance"}),h?(0,c.jsx)("input",{type:"number",value:F.expectedAttendance,onChange:e=>B("expectedAttendance",parseInt(e.target.value)||0),min:"1"}):(0,c.jsx)("div",{className:"read-only-value",children:F.expectedAttendance||0})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Event Image"}),h?(0,c.jsx)(b.Z,{uploadText:"Drag your image here",onFileSelect:e=>B("image",e),onFileClear:()=>B("image",null),showPrompt:!1}):(0,c.jsx)("div",{className:"read-only-value",children:r.image?(0,c.jsx)("img",{src:r.image,alt:"Event",style:{maxWidth:"200px",maxHeight:"200px"}}):"No image"})]})]})]}),(0,c.jsxs)("div",{className:"editor-section",children:[(0,c.jsx)("h3",{children:"Date, Time & Location"}),(0,c.jsxs)("div",{className:"section-content",children:[(0,c.jsxs)("div",{className:"field-row",children:[(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Event Time"}),(0,c.jsxs)("div",{className:"read-only-value",children:[Q(F.start_time)," - ",V(F.end_time)]})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Location"}),h?(0,c.jsx)("input",{type:"text",value:F.location||"",onChange:e=>B("location",e.target.value),placeholder:"e.g. Room 101, Off-campus, or address"}):(0,c.jsx)("div",{className:"read-only-value",children:F.location||"Not set"})]})]}),h&&(0,c.jsx)("div",{className:"field-group",children:(0,c.jsxs)("button",{type:"button",className:"change-location-time-button",onClick:()=>{C("location"),k(!0)},children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock"}),"Change Location & Time"]})})]})]}),(0,c.jsxs)("div",{className:"editor-section",children:[(0,c.jsx)("h3",{children:"Contact & Links"}),(0,c.jsxs)("div",{className:"section-content",children:[(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"Contact"}),h?(0,c.jsx)("input",{type:"text",value:F.contact||"",onChange:e=>B("contact",e.target.value),placeholder:"Contact information"}):(0,c.jsx)("div",{className:"read-only-value",children:F.contact||"Not set"})]}),(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsx)("label",{children:"External Link"}),h?(0,c.jsx)("input",{type:"url",value:F.externalLink||"",onChange:e=>B("externalLink",e.target.value),placeholder:"https://..."}):(0,c.jsx)("div",{className:"read-only-value",children:F.externalLink?(0,c.jsx)("a",{href:F.externalLink,target:"_blank",rel:"noopener noreferrer",children:F.externalLink}):"Not set"})]})]})]}),H.length>0&&(0,c.jsxs)("div",{className:"editor-section",children:[(0,c.jsx)("h3",{children:"Additional Information"}),(0,c.jsx)("div",{className:"section-content",children:H.map((e=>(0,c.jsxs)("div",{className:"field-group",children:[(0,c.jsxs)("label",{children:[e.label,e.isRequired&&(0,c.jsx)("span",{className:"required",children:"*"})]}),h?(0,c.jsx)(j.Z,{field:e,value:F[e.name],onChange:B,formData:F}):(0,c.jsx)("div",{className:"read-only-value",children:null!==F[e.name]&&void 0!==F[e.name]?String(F[e.name]):"Not set"})]},e.name)))})]})]}),Y&&(0,x.createPortal)((0,c.jsx)("div",{className:"event-editor-config-panel",children:G}),Y),y&&(0,c.jsx)(f.Z,{isOpen:y,onClose:z,customClassName:"location-time-popup",children:(0,c.jsx)(J,{popupStep:w,popupFormData:Z,setPopupFormData:U,onLocationSelected:()=>{C("time"),_({selectedRoomIds:Z.selectedRoomIds,location:Z.location,classroom_id:Z.classroom_id})},onTimeSelected:()=>{Z.start_time&&Z.end_time&&M((e=>{const t=Z.selectedRoomIds&&Z.selectedRoomIds.length>0;return{...e,start_time:Z.start_time,end_time:Z.end_time,...t?{selectedRoomIds:Z.selectedRoomIds,classroom_id:Z.classroom_id||Z.selectedRoomIds[0],location:Z.location||e.location}:{}}})),z()},onClose:z,onBack:()=>C("location")})})]})};const $=function(e){let{item:t,onEdit:s,onDelete:n}=e;const a=e=>{if(!e)return"TBD";return(e instanceof Date?e:new Date(e)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},l=t.startTime?"string"===typeof t.startTime?new Date(t.startTime):t.startTime:null,r=t.endTime?"string"===typeof t.endTime?new Date(t.endTime):t.endTime:null,o=(()=>{if(!t.startTime||!t.endTime)return null;const e=t.startTime instanceof Date?t.startTime:new Date(t.startTime),s=t.endTime instanceof Date?t.endTime:new Date(t.endTime);return Math.round((s-e)/6e4)})();return(0,c.jsxs)("div",{className:"agenda-item",children:[(0,c.jsxs)("div",{className:"item-content",children:[(0,c.jsxs)("div",{className:"item-header",children:[(0,c.jsxs)("div",{className:"item-type-badge",style:{backgroundColor:(d=t.type,{Activity:"#4DAA57",Break:"#ffc107",Setup:"#6c757d",Breakdown:"#6c757d",Transition:"#17a2b8",Speaker:"#dc3545",Custom:"#6D8EFA"}[d]||"#6c757d")},children:[(0,c.jsx)(i.JO,{icon:(e=>({Activity:"mdi:run",Break:"mdi:coffee",Setup:"mdi:wrench",Breakdown:"mdi:package-down",Transition:"mdi:arrow-right",Speaker:"mdi:microphone",Custom:"mdi:star"}[e]||"mdi:circle"))(t.type)}),(0,c.jsx)("span",{children:t.type})]}),!t.isPublic&&(0,c.jsxs)("span",{className:"item-visibility",children:[(0,c.jsx)(i.JO,{icon:"mdi:lock"}),(0,c.jsx)("span",{children:"Internal"})]})]}),(0,c.jsx)("h4",{className:"item-title",children:t.title}),t.description&&(0,c.jsx)("p",{className:"item-description",children:t.description}),(0,c.jsxs)("div",{className:"item-meta",children:[l&&r&&(0,c.jsxs)("span",{className:"meta-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),a(l)," - ",a(r)]}),null!=o&&(0,c.jsxs)("span",{className:"meta-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:timer-outline"}),o," min"]}),t.location&&(0,c.jsxs)("span",{className:"meta-item",children:[(0,c.jsx)(i.JO,{icon:"fluent:location-28-filled"}),t.location]})]})]}),(0,c.jsxs)("div",{className:"item-actions",children:[(0,c.jsx)("button",{className:"action-btn edit",onClick:s,title:"Edit",children:(0,c.jsx)(i.JO,{icon:"mdi:pencil"})}),(0,c.jsx)("button",{className:"action-btn delete",onClick:n,title:"Delete",children:(0,c.jsx)(i.JO,{icon:"mdi:delete"})})]})]});var d};const q=function(e){let{item:t,event:s,latestItemEnd:a,onSave:l,onCancel:r}=e;const[o,d]=(0,n.useState)("duration"),[m,u]=(0,n.useState)({title:"",description:"",startTime:null,endTime:null,durationMinutes:30,type:"Activity",location:"",isPublic:!0});(0,n.useEffect)((()=>{if(t){let e=null,n=null;if(t.startTime&&(e="string"===typeof t.startTime?new Date(t.startTime):t.startTime),t.endTime&&(n="string"===typeof t.endTime?new Date(t.endTime):t.endTime),!e||!n){const t=a?a instanceof Date?a:new Date(a):null!==s&&void 0!==s&&s.start_time?new Date(s.start_time):new Date,i=new Date(t);i.setMinutes(i.getMinutes()+30),e=e||t,n=n||i}const i=e&&n?Math.max(1,Math.round((n-e)/6e4)):30;u({title:t.title||"",description:t.description||"",startTime:e,endTime:n,durationMinutes:i,type:t.type||"Activity",location:t.location||"",isPublic:void 0===t.isPublic||t.isPublic})}else if(null!==s&&void 0!==s&&s.start_time||a){const e=a?a instanceof Date?a:new Date(a):new Date(s.start_time),t=new Date(e);t.setMinutes(t.getMinutes()+30),u((s=>({...s,startTime:e,endTime:t,durationMinutes:30})))}}),[t,s,a]);const h=e=>{if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},v=(e,t)=>{u((s=>{const n={...s};if("startTime"===e){const e=t?new Date(t):null;if(n.startTime=e,e&&n.endTime){const t=new Date(n.endTime);t>e&&(n.durationMinutes=Math.max(1,Math.round((t-e)/6e4)))}}else if("endTime"===e){const e=t?new Date(t):null;if(n.endTime=e,e&&n.startTime){const t=new Date(n.startTime);e>t&&(n.durationMinutes=Math.max(1,Math.round((e-t)/6e4)))}}else if("durationMinutes"===e){const e=parseInt(t,10);if(e>0&&n.startTime){n.durationMinutes=e;const t=new Date(n.startTime),s=new Date(t);s.setMinutes(s.getMinutes()+e),n.endTime=s}else n.durationMinutes=t}else n[e]=t;return n}))};return(0,c.jsx)(f.Z,{isOpen:!0,onClose:r,customClassName:"agenda-item-editor-popup",children:(0,c.jsxs)("div",{className:"agenda-item-editor",children:[(0,c.jsxs)("div",{className:"editor-header",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:pencil"}),null!==t&&void 0!==t&&t.id&&!t.id.startsWith("item-")?"Edit":"Create"," Agenda Item"]}),(0,c.jsx)("button",{className:"close-btn",onClick:r,children:(0,c.jsx)(i.JO,{icon:"mdi:close"})})]}),(0,c.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!m.title||""===m.title.trim())return void alert("Please enter a title.");let s=m.startTime,n=m.endTime;if("duration"===o){const e=parseInt(m.durationMinutes,10);if(!e||e<=0)return void alert("Please enter a valid duration.");s=m.startTime?new Date(m.startTime):null,n=s?new Date(s):null,n&&n.setMinutes(n.getMinutes()+e)}else{if(!s||!n)return void alert("Please enter a start time and end time.");if(s=new Date(s),n=new Date(n),n<=s)return void alert("End time must be after start time.")}const i={...t,...m,startTime:s instanceof Date?s:new Date(s),endTime:n instanceof Date?n:new Date(n)};delete i.durationMinutes,l(i)},className:"editor-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{children:["Title ",(0,c.jsx)("span",{className:"required",children:"*"})]}),(0,c.jsx)("input",{type:"text",value:m.title,onChange:e=>v("title",e.target.value),required:!0,placeholder:"Agenda item title"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Description"}),(0,c.jsx)("textarea",{value:m.description,onChange:e=>v("description",e.target.value),rows:4,placeholder:"Item description"})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Type"}),(0,c.jsx)("select",{value:m.type,onChange:e=>v("type",e.target.value),children:["Activity","Break","Setup","Breakdown","Transition","Speaker","Custom"].map((e=>(0,c.jsx)("option",{value:e,children:e},e)))})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Location"}),(0,c.jsx)("input",{type:"text",value:m.location,onChange:e=>v("location",e.target.value),placeholder:"Location"})]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"How to specify time"}),(0,c.jsxs)("div",{className:"input-mode-toggle",children:[(0,c.jsxs)("button",{type:"button",className:"mode-btn "+("duration"===o?"active":""),onClick:()=>d("duration"),children:[(0,c.jsx)(i.JO,{icon:"mdi:timer-outline"}),(0,c.jsx)("span",{children:"Duration"})]}),(0,c.jsxs)("button",{type:"button",className:"mode-btn "+("endTime"===o?"active":""),onClick:()=>d("endTime"),children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),(0,c.jsx)("span",{children:"End Time"})]})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Start Time"}),(0,c.jsx)("input",{type:"datetime-local",value:m.startTime?h(m.startTime):"",onChange:e=>v("startTime",e.target.value),required:!0})]}),"duration"===o?(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Duration (minutes)"}),(0,c.jsx)("input",{type:"number",min:"1",value:m.durationMinutes,onChange:e=>v("durationMinutes",e.target.value),placeholder:"e.g., 30",required:!0}),(0,c.jsx)("p",{className:"help-text",children:"End time is calculated from start + duration"})]}):(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"End Time"}),(0,c.jsx)("input",{type:"datetime-local",value:m.endTime?h(m.endTime):"",onChange:e=>v("endTime",e.target.value),required:!0})]})]}),(0,c.jsxs)("div",{className:"form-group checkbox-group",children:[(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",checked:m.isPublic,onChange:e=>v("isPublic",e.target.checked)}),(0,c.jsx)("span",{children:"Public (visible to attendees)"})]}),(0,c.jsx)("p",{className:"help-text",children:"Uncheck to make this item internal-only"})]}),(0,c.jsxs)("div",{className:"form-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:r,children:"Cancel"}),(0,c.jsxs)("button",{type:"submit",className:"btn-save",children:[(0,c.jsx)(i.JO,{icon:"mdi:check"}),(0,c.jsx)("span",{children:"Save Item"})]})]})]})]})})};const F=function(e){let{event:t,orgId:s,timeDifference:a,onConfirm:r,onCancel:o,onPublishWithoutAdjusting:d,isOpen:m=!0}=e;const{addNotification:u}=(0,l.l)(),[h,v]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),[x,j]=(0,n.useState)(null),b=(null===a||void 0===a?void 0:a.isOver)||!1,y=(null===a||void 0===a?void 0:a.isUnder)||!1,k=Math.abs((null===a||void 0===a?void 0:a.difference)||0),w=(()=>{if(null===t||void 0===t||!t.start_time||null===t||void 0===t||!t.end_time)return null;const e=new Date(t.end_time),s=new Date(e);return s.setMinutes(s.getMinutes()+a.difference),s})();(0,n.useEffect)((()=>{(b||y)&&null!==t&&void 0!==t&&t.classroom_id&&w?C():null!==t&&void 0!==t&&t.classroom_id||p(!0)}),[]);const C=async()=>{if(null!==t&&void 0!==t&&t._id&&s&&w){v(!0);try{try{const e=await(0,N.Z)(`/rooms/${t.classroom_id}`,null,{method:"GET"});e.success&&e.room&&j(e.room.name)}catch(e){console.warn("Could not fetch room name:",e)}const n=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/check-room-availability`,{startTime:t.start_time,endTime:w.toISOString()},{method:"POST"});n.success?p(n.data.isAvailable):p(!1)}catch(n){console.error("Error checking room availability:",n),p(!1)}finally{v(!1)}}},S=()=>{!1!==g?w&&r(w.toISOString()):u({title:"Room Unavailable",message:"The room is not available for the extended time. Please adjust your agenda or choose a different time.",type:"error"})},_=e=>{if(!e)return"";return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})};return(0,c.jsx)(f.Z,{isOpen:m,onClose:o,defaultStyling:!0,customClassName:"publish-confirm-modal-popup",children:(0,c.jsxs)("div",{className:"publish-confirm-modal",children:[(0,c.jsx)("div",{className:"modal-header",children:(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:publish"}),"Publish Agenda"]})}),(0,c.jsxs)("div",{className:"modal-content",children:[(0,c.jsxs)("div",{className:"publish-info-note",children:[(0,c.jsx)(i.JO,{icon:"mdi:information-outline"}),(0,c.jsx)("span",{children:"Your agenda is already saved. Publishing makes it visible to attendees on the event page."})]}),b&&(0,c.jsxs)("div",{className:"time-warning-section over",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle"}),(0,c.jsxs)("div",{className:"warning-content",children:[(0,c.jsx)("h4",{children:"Agenda exceeds event time"}),(0,c.jsxs)("p",{children:["Your agenda is ",(0,c.jsxs)("strong",{children:[k," minutes"]})," longer than the scheduled event time."]})]})]}),y&&(0,c.jsxs)("div",{className:"time-warning-section under",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle-outline"}),(0,c.jsxs)("div",{className:"warning-content",children:[(0,c.jsx)("h4",{children:"Agenda shorter than event time"}),(0,c.jsxs)("p",{children:["Your agenda is ",(0,c.jsxs)("strong",{children:[k," minutes"]})," shorter than the scheduled event time."]})]})]}),(b||y)&&(0,c.jsxs)("div",{className:"time-comparison",children:[(0,c.jsxs)("div",{className:"time-row",children:[(0,c.jsx)("span",{className:"time-label",children:"Current end time:"}),(0,c.jsx)("span",{className:"time-value",children:_(null===t||void 0===t?void 0:t.end_time)})]}),(0,c.jsxs)("div",{className:"time-row",children:[(0,c.jsx)("span",{className:"time-label",children:"Proposed end time:"}),(0,c.jsx)("span",{className:"time-value "+(b?"over":"under"),children:_(w)})]})]}),(null===t||void 0===t?void 0:t.classroom_id)&&(b||y)&&(0,c.jsx)("div",{className:"room-availability-section",children:h?(0,c.jsxs)("div",{className:"availability-checking",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("span",{children:"Checking room availability..."})]}):!0===g?(0,c.jsxs)("div",{className:"availability-status available",children:[(0,c.jsx)(i.JO,{icon:"mdi:check-circle"}),(0,c.jsxs)("span",{children:[x?`Room "${x}" is available`:"Room is available"," for the extended time"]})]}):!1===g?(0,c.jsxs)("div",{className:"availability-status unavailable",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle"}),(0,c.jsxs)("span",{children:[x?`Room "${x}" is unavailable`:"Room is unavailable"," for the extended time"]})]}):null}),!(null!==t&&void 0!==t&&t.classroom_id)&&(b||y)&&(0,c.jsxs)("div",{className:"no-room-notice",children:[(0,c.jsx)(i.JO,{icon:"mdi:information"}),(0,c.jsx)("span",{children:"No room reserved for this event. Time adjustment will proceed without room check."})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(b||y)&&(0,c.jsx)("button",{className:"btn-adjust "+(!1===g?"disabled":""),onClick:S,disabled:!1===g||h,children:"Adjust Time & Publish"}),(0,c.jsx)("button",{className:"btn-publish-without",onClick:b||y?d:S,children:b||y?"Publish Without Adjusting":"Publish"})]})]})})};var M=s(50188),L=s(71096),P=s(72547);const Z=[{id:"compact",label:"Compact",value:1},{id:"normal",label:"Normal",value:3},{id:"expanded",label:"Expanded",value:5}];const U=function(e){var t,s;let{event:r,orgId:o,onRefresh:d,isTabActive:m=!0}=e;const{addNotification:u}=(0,l.l)(),[h,v]=(0,n.useState)([]),[p,j]=(0,n.useState)(null),[b,f]=(0,n.useState)(!1),[y,k]=(0,n.useState)(!1),[w,C]=(0,n.useState)(!1),[S,_]=(0,n.useState)(!1),[I,E]=(0,n.useState)(!1),[D,T]=(0,n.useState)(null),[R,O]=(0,n.useState)((()=>(0,P.q)().viewMode)),[J,A]=(0,n.useState)((()=>(0,P.q)().calendarMinuteHeight));(0,n.useEffect)((()=>{localStorage.setItem("meridian-agenda-view",JSON.stringify({viewMode:R,calendarMinuteHeight:J}))}),[R,J]);const[U,B]=(0,n.useState)(!1),z=(0,n.useRef)(null),{data:V,loading:Q,refetch:W}=(0,a.i)(null!==r&&void 0!==r&&r._id&&o?`/org-event-management/${o}/events/${r._id}/agenda`:null);(0,n.useEffect)((()=>{var e;if(null!==V&&void 0!==V&&V.success&&null!==(e=V.data)&&void 0!==e&&e.agenda){const e=V.data.agenda;k(e.isPublished||!1);const t=null!==r&&void 0!==r&&r.start_time?new Date(r.start_time):new Date;let s=new Date(t);const n=(e.items||[]).map(((e,t)=>{const n={...e};if(e.startTime&&"string"===typeof e.startTime&&(n.startTime=new Date(e.startTime)),e.endTime&&"string"===typeof e.endTime&&(n.endTime=new Date(e.endTime)),n.startTime&&n.endTime)s=new Date(n.endTime);else{const t=parseInt(e.durationMinutes,10)||30;n.startTime=new Date(s),n.endTime=new Date(s),n.endTime.setMinutes(n.endTime.getMinutes()+t),s=new Date(n.endTime)}return n}));v(n)}}),[V,null===r||void 0===r?void 0:r.start_time]);const H=()=>{if(0===h.length)return null!==r&&void 0!==r&&r.start_time?new Date(r.start_time):new Date;const e=[...h].sort(((e,t)=>(e.order||0)-(t.order||0))),t=e[e.length-1];return t.endTime?new Date(t.endTime):new Date((null===r||void 0===r?void 0:r.start_time)||Date.now())},Y=()=>{const e=H(),t=new Date(e),s=new Date(e);s.setMinutes(s.getMinutes()+30);const n={id:`item-${Date.now()}`,title:"New Agenda Item",description:"",startTime:t,endTime:s,type:"Activity",location:"",assignedRoles:[],isPublic:!0,order:h.length};j(n)},G=e=>{j(e)},K=()=>{if(null===r||void 0===r||!r.start_time||null===r||void 0===r||!r.end_time||0===h.length)return null;const e=h.reduce(((e,t)=>{if(t.startTime&&t.endTime){const s=new Date(t.startTime),n=new Date(t.endTime);return e+Math.round((n-s)/6e4)}return e}),0),t=new Date(r.start_time),s=new Date(r.end_time),n=Math.round((s-t)/6e4),i=e-n;return{agendaDuration:e,eventDuration:n,difference:i,isOver:i>0,isUnder:i<0,isExact:0===i}},X=()=>{if(null===r||void 0===r||!r._id||!o)return;if(0===h.length)return void u({title:"Error",message:"Cannot publish an empty agenda",type:"error"});const e=K();e&&!e.isExact?_(!0):ee()},ee=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==r&&void 0!==r&&r._id&&o){C(!0);try{const t=e?{newEndTime:e}:{},s=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}/agenda/publish`,t,{method:"POST"});if(!s.success)throw new Error(s.message||"Failed to publish agenda");k(!0),_(!1),d&&d(),u({title:"Success",message:e?"Agenda published and event time adjusted successfully":"Agenda published successfully",type:"success"})}catch(t){u({title:"Error",message:t.message||"Failed to publish agenda",type:"error"})}finally{C(!1)}}},te=(0,n.useCallback)((()=>{const e=z.current,t=(null===e||void 0===e?void 0:e.closest(".dashboard-overlay"))||(null===e||void 0===e?void 0:e.parentElement);if(!e||!t)return;const s=e.getBoundingClientRect(),n=t.getBoundingClientRect().top+60;B(s.bottom<n)}),[]);if((0,n.useEffect)((()=>{const e=z.current,t=(null===e||void 0===e?void 0:e.closest(".dashboard-overlay"))||(null===e||void 0===e?void 0:e.parentElement);if(!t)return;const s=()=>requestAnimationFrame(te);return te(),t.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s),()=>{t.removeEventListener("scroll",s),window.removeEventListener("resize",s)}}),[te,Q]),Q)return(0,c.jsxs)("div",{className:"agenda-builder loading",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("p",{children:"Loading agenda..."})]});const se=K();return(0,c.jsxs)("div",{className:"agenda-builder",children:[(0,c.jsxs)("div",{ref:z,className:"agenda-header",children:[(0,c.jsxs)("div",{className:"header-left",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock"}),"Event Agenda"]}),(0,c.jsxs)("div",{className:"header-meta",children:[(0,c.jsxs)("p",{children:[h.length," item",1!==h.length?"s":""]}),se&&!se.isExact&&(0,c.jsxs)("span",{className:"time-warning "+(se.isOver?"over":"under"),children:[(0,c.jsx)(i.JO,{icon:se.isOver?"mdi:alert-circle":"mdi:alert-circle-outline"}),se.isOver?`${Math.abs(se.difference)} min over`:`${Math.abs(se.difference)} min under`]}),y?(0,c.jsxs)("span",{className:"publish-status published",title:"Agenda is visible to attendees",children:[(0,c.jsx)(i.JO,{icon:"mdi:check-circle"}),"Published"]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("span",{className:"publish-status saved",title:"Your changes are saved to the database",children:[(0,c.jsx)(i.JO,{icon:"mdi:content-save-check"}),"Saved"]}),(0,c.jsxs)("span",{className:"publish-status draft",title:"Not visible to attendees. Click Publish when ready.",children:[(0,c.jsx)(i.JO,{icon:"mdi:eye-off-outline"}),"Draft"]})]})]})]}),(0,c.jsxs)("div",{className:"header-actions",children:[(0,c.jsxs)("div",{className:"view-toggle",children:[(0,c.jsx)("label",{className:"view-label",children:"View:"}),(0,c.jsxs)("button",{className:"view-btn "+("creator"===R?"active":""),onClick:()=>O("creator"),title:"Creator View - Sequential list of items",children:[(0,c.jsx)(i.JO,{icon:"mdi:format-list-numbered"}),(0,c.jsx)("span",{children:"List"})]}),(0,c.jsxs)("button",{className:"view-btn "+("calendar"===R?"active":""),onClick:()=>O("calendar"),title:"Calendar View - Google-style timeline",children:[(0,c.jsx)(i.JO,{icon:"mdi:view-timeline"}),(0,c.jsx)("span",{children:"Calendar"})]})]}),(0,c.jsxs)("button",{className:"btn-primary",onClick:Y,children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),(0,c.jsx)("span",{children:"Add Item"})]}),!y&&h.length>0&&(0,c.jsxs)("button",{className:"btn-publish",onClick:X,disabled:w,title:"Make the agenda visible to attendees. Your changes are already saved.",children:[(0,c.jsx)(i.JO,{icon:w?"mdi:loading":"mdi:publish",className:w?"spinner":""}),(0,c.jsx)("span",{children:w?"Publishing...":"Publish"})]}),b&&(0,c.jsxs)("span",{className:"saving-indicator",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),"Saving..."]})]})]}),U&&m&&(0,x.createPortal)((0,c.jsxs)("div",{className:"agenda-floating-actions",children:[(0,c.jsxs)("button",{className:"btn-primary",onClick:Y,children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),(0,c.jsx)("span",{children:"Add Item"})]}),!y&&h.length>0&&(0,c.jsxs)("button",{className:"btn-publish",onClick:X,disabled:w,children:[(0,c.jsx)(i.JO,{icon:w?"mdi:loading":"mdi:publish",className:w?"spinner":""}),(0,c.jsx)("span",{children:w?"Publishing...":"Publish"})]})]}),document.body),"calendar"===R?(0,c.jsxs)("div",{className:"agenda-calendar-wrapper",children:[(0,c.jsxs)("div",{className:"calendar-zoom-controls",children:[(0,c.jsx)("label",{className:"zoom-label",children:"Zoom:"}),Z.map((e=>(0,c.jsx)("button",{type:"button",className:"zoom-btn "+(J===e.id?"active":""),onClick:()=>A(e.id),title:`${e.label} (${e.value}px/min)`,children:e.label},e.id)))]}),(0,c.jsx)(g.Z,{agendaItems:h,event:r,minuteHeight:null!==(t=null===(s=Z.find((e=>e.id===J)))||void 0===s?void 0:s.value)&&void 0!==t?t:4,onEditItem:G})]}):0===h.length?(0,c.jsx)(L.Z,{icon:"mdi:calendar-blank",title:"No agenda items yet",description:"Start building your event agenda by adding items.",actions:[{label:"Add first item",onClick:Y,primary:!0}]}):(0,c.jsx)("div",{className:"agenda-items-container",children:[...h].sort(((e,t)=>(e.order||0)-(t.order||0))).map((e=>(0,c.jsx)($,{item:e,onEdit:()=>G(e),onDelete:()=>{return t=e.id,T(t),void E(!0);var t}},e.id)))}),p&&(0,c.jsx)(q,{item:p,event:r,latestItemEnd:h.length>0?H():null,onSave:async e=>{const{durationMinutes:t,...s}=e,n={...s};e.startTime&&(n.startTime=e.startTime instanceof Date?e.startTime:new Date(e.startTime)),e.endTime&&(n.endTime=e.endTime instanceof Date?e.endTime:new Date(e.endTime));const i=h.findIndex((e=>e.id===n.id));let a;i>=0?(a=[...h],a[i]={...n,order:a[i].order}):a=[...h,{...n,order:h.length}],v(a),j(null),await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;if(null===r||void 0===r||!r._id||!o)return{success:!1,message:"Missing event ID or org ID"};f(!0);try{const t=e.map((e=>{const{durationMinutes:t,...s}=e,n={...s};return e.startTime&&(n.startTime="string"===typeof e.startTime?e.startTime:new Date(e.startTime).toISOString()),e.endTime&&(n.endTime="string"===typeof e.endTime?e.endTime:new Date(e.endTime).toISOString()),n})),s=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}/agenda`,{items:t},{method:"POST"});if(s.success)return k(!1),d&&d(),{success:!0};throw new Error(s.message||"Failed to save agenda")}catch(t){return u({title:"Error",message:t.message||"Failed to save agenda",type:"error"}),{success:!1,message:t.message||"Failed to save agenda"}}finally{f(!1)}}(a)},onCancel:()=>j(null)}),S&&se&&(0,c.jsx)(F,{event:r,orgId:o,timeDifference:se,onConfirm:e=>{ee(e)},onCancel:()=>_(!1),onPublishWithoutAdjusting:()=>{ee()}}),(0,c.jsx)(M.Z,{isOpen:I,onConfirm:async()=>{if(D&&null!==r&&void 0!==r&&r._id&&o)try{const e=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}/agenda/items/${D}`,{},{method:"DELETE"});if(!e.success)throw new Error(e.message||"Failed to delete item");v(h.filter((e=>e.id!==D))),k(!1),d&&d(),u({title:"Success",message:"Agenda item deleted",type:"success"})}catch(e){u({title:"Error",message:e.message||"Failed to delete agenda item",type:"error"})}finally{E(!1),T(null)}},onCancel:()=>{E(!1),T(null)},title:"Delete Agenda Item",message:"Are you sure you want to delete this agenda item? This will remove the item from the agenda.",warningDetails:"This action cannot be undone."})]})};const B=function(e){let{roles:t,event:s}=e;if(!t||0===t.length||!s)return null;const n=e=>e?new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"TBD",a=t.filter((e=>e.shiftStart&&e.shiftEnd));return 0===a.length?(0,c.jsxs)("div",{className:"shift-scheduler",children:[(0,c.jsxs)("h4",{children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock"}),"Shift Schedule"]}),(0,c.jsx)("p",{className:"no-shifts",children:"Shift Scheduling Coming Soon."})]}):(0,c.jsxs)("div",{className:"shift-scheduler",children:[(0,c.jsxs)("h4",{children:[(0,c.jsx)(i.JO,{icon:"mdi:calendar-clock"}),"Shift Schedule"]}),(0,c.jsx)("div",{className:"shifts-timeline",children:a.map((e=>{var t;return(0,c.jsxs)("div",{className:"shift-item",children:[(0,c.jsxs)("div",{className:"shift-role",children:[(0,c.jsx)("strong",{children:e.name}),(0,c.jsxs)("span",{className:"shift-time",children:[n(e.shiftStart)," - ",n(e.shiftEnd)]})]}),(0,c.jsx)("div",{className:"shift-coverage",children:(0,c.jsxs)("span",{children:[(null===(t=e.assignments)||void 0===t?void 0:t.filter((e=>"confirmed"===e.status)).length)||0," / ",e.requiredCount]})})]},e._id)}))})]})};var z=s(86769);const V=function(e){let{orgRoles:t,roles:s,creatingJobTemplate:n,setCreatingJobTemplate:a,newJobTemplate:l,setNewJobTemplate:r,onCreateJobTemplate:o,onIncrementJob:d,onDecrementJob:m,onClose:u}=e;return(0,c.jsxs)(z.Z,{classN:"job-picker",icon:"mdi:briefcase",header:"Add Job Slots",right:(0,c.jsxs)("div",{className:"header-actions",children:[(0,c.jsxs)("button",{className:"btn-secondary",onClick:()=>a((e=>!e)),children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),n?"Cancel":"New Template"]}),(0,c.jsx)("button",{className:"close-btn",onClick:u,type:"button","aria-label":"Close",children:(0,c.jsx)(i.JO,{icon:"mdi:close"})})]}),children:[n&&(0,c.jsxs)("div",{className:"job-template-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Template Name *"}),(0,c.jsx)("input",{type:"text",value:l.name,onChange:e=>r((t=>({...t,name:e.target.value}))),placeholder:"e.g., Registration, Ticketing"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Description"}),(0,c.jsx)("textarea",{rows:2,value:l.description,onChange:e=>r((t=>({...t,description:e.target.value}))),placeholder:"Describe this job template"})]}),(0,c.jsx)("div",{className:"form-actions",children:(0,c.jsxs)("button",{className:"btn-save",onClick:o,disabled:!l.name.trim(),children:[(0,c.jsx)(i.JO,{icon:"mdi:check"}),"Create & Add Slot"]})})]}),(0,c.jsx)("div",{className:"job-picker-list",children:t.map((e=>{const t=s.find((t=>{var s;return((null===(s=t.orgRoleId)||void 0===s?void 0:s._id)||t.orgRoleId)===e._id})),n=(null===t||void 0===t?void 0:t.requiredCount)||0;return(0,c.jsxs)("div",{className:"job-picker-item",children:[(0,c.jsxs)("div",{className:"job-info",children:[(0,c.jsx)("strong",{children:e.name}),e.description&&(0,c.jsx)("p",{children:e.description})]}),(0,c.jsxs)("div",{className:"job-actions",children:[(0,c.jsx)("button",{className:"action-btn remove",onClick:()=>m(e),title:"Remove slot",disabled:n<=0,children:(0,c.jsx)(i.JO,{icon:"mdi:minus"})}),(0,c.jsx)("span",{className:"job-count",children:n}),(0,c.jsx)("button",{className:"action-btn add",onClick:()=>d(e),title:"Add slot",children:(0,c.jsx)(i.JO,{icon:"mdi:plus"})})]})]},e._id)}))})]})};const Q=function(e){let{event:t,orgId:s,roles:a,onClose:r,onSuccess:o}=e;const{addNotification:d}=(0,l.l)(),[m,u]=(0,n.useState)(""),[h,v]=(0,n.useState)(""),[g,p]=(0,n.useState)(""),[x,j]=(0,n.useState)(!1),b=(null===a||void 0===a?void 0:a.filter((e=>{var t;return((null===(t=e.assignments)||void 0===t?void 0:t.filter((e=>"confirmed"===e.status)).length)||0)<e.requiredCount})))||[];return 0===b.length?(0,c.jsx)(z.Z,{classN:"volunteer-signup",icon:"mdi:account-plus",header:"Volunteer Signup",right:(0,c.jsx)("button",{className:"close-btn",onClick:r,type:"button","aria-label":"Close",children:(0,c.jsx)(i.JO,{icon:"mdi:close"})}),children:(0,c.jsxs)("div",{className:"no-roles-available",children:[(0,c.jsx)(i.JO,{icon:"mdi:information"}),(0,c.jsx)("p",{children:"No jobs available for signup. All jobs are fully staffed."})]})}):(0,c.jsx)(z.Z,{classN:"volunteer-signup",icon:"mdi:account-plus",header:"Volunteer Signup",right:(0,c.jsx)("button",{className:"close-btn",onClick:r,type:"button","aria-label":"Close",children:(0,c.jsx)(i.JO,{icon:"mdi:close"})}),children:(0,c.jsxs)("div",{className:"signup-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{children:["Select Job ",(0,c.jsx)("span",{className:"required",children:"*"})]}),(0,c.jsxs)("select",{value:m,onChange:e=>u(e.target.value),required:!0,children:[(0,c.jsx)("option",{value:"",children:"Choose a job"}),b.map((e=>{var t;const s=(null===(t=e.assignments)||void 0===t?void 0:t.filter((e=>"confirmed"===e.status)).length)||0,n=e.requiredCount-s;return(0,c.jsxs)("option",{value:e._id,children:[e.name," (",n," spot",1!==n?"s":""," available)"]},e._id)}))]})]}),m&&(()=>{const e=b.find((e=>e._id===m));return!e||e.shiftStart&&e.shiftEnd?null:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Shift Start (Optional)"}),(0,c.jsx)("input",{type:"datetime-local",value:h,onChange:e=>v(e.target.value)})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Shift End (Optional)"}),(0,c.jsx)("input",{type:"datetime-local",value:g,onChange:e=>p(e.target.value)})]})]})})(),(0,c.jsxs)("div",{className:"form-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:r,children:"Cancel"}),(0,c.jsx)("button",{type:"button",className:"btn-save",onClick:async()=>{if(m){if(null!==t&&void 0!==t&&t._id&&s){j(!0);try{const e=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/volunteer-signups`,{roleId:m,shiftStart:h||null,shiftEnd:g||null},{method:"POST"});if(!e.success)throw new Error(e.message||"Failed to sign up");d({title:"Success",message:"You have successfully signed up for this job",type:"success"}),o&&o(),r()}catch(e){d({title:"Error",message:e.message||"Failed to sign up for job",type:"error"})}finally{j(!1)}}}else d({title:"Error",message:"Please select a job",type:"error"})},disabled:!m||x,children:x?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("span",{children:"Signing Up..."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.JO,{icon:"mdi:check"}),(0,c.jsx)("span",{children:"Sign Up"})]})})]})]})})};var W=s(7768);const H=function(e){var t,s,a;let{members:l,selectedMemberId:r,onMemberSelect:o,disabled:d,placeholder:m="Select member"}=e;const[u,h]=(0,n.useState)(!1),[v,g]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),j=(0,n.useRef)(null),b=l.find((e=>{var t,s,n;return((null===(t=e.user_id)||void 0===t||null===(s=t._id)||void 0===s?void 0:s.toString())||(null===(n=e.user_id)||void 0===n?void 0:n.toString()))===r}));return(0,n.useEffect)((()=>{if(!u){g(!1);const e=setTimeout((()=>{x(!1)}),200);return()=>clearTimeout(e)}x(!0),g(!0)}),[u]),(0,n.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&h(!1)};return u&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[u]),(0,c.jsxs)("div",{className:"member-dropdown",ref:j,onClick:e=>{d||(e.stopPropagation(),h(!u))},children:[b?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("img",{src:(null===(t=b.user_id)||void 0===t?void 0:t.picture)||W.Z,alt:(null===(s=b.user_id)||void 0===s?void 0:s.name)||"Member"}),(0,c.jsx)("h1",{children:(null===(a=b.user_id)||void 0===a?void 0:a.name)||"Unknown"})]}):(0,c.jsx)("h1",{children:m}),(0,c.jsx)(i.JO,{icon:""+(u?"ic:round-keyboard-arrow-up":"ic:round-keyboard-arrow-down"),width:"20",height:"20"}),p&&(0,c.jsx)("div",{className:"dropdown "+(v?"":"dropdown-exit"),onClick:e=>e.stopPropagation(),children:(0,c.jsx)("div",{className:"member-list",children:0===l.length?(0,c.jsx)("div",{className:"no-members",children:(0,c.jsx)("p",{children:"No members available"})}):l.map((e=>{var t,s,n,i,a,l;const d=(null===(t=e.user_id)||void 0===t||null===(s=t._id)||void 0===s?void 0:s.toString())||(null===(n=e.user_id)||void 0===n?void 0:n.toString()),m=d===r;return(0,c.jsxs)("div",{className:"drop-option "+(m?"selected":""),onClick:()=>(e=>{var t;const s=(null===(t=e.user_id)||void 0===t?void 0:t._id)||e.user_id;o&&o(s),h(!1)})(e),children:[(0,c.jsx)("img",{src:(null===(i=e.user_id)||void 0===i?void 0:i.picture)||W.Z,alt:(null===(a=e.user_id)||void 0===a?void 0:a.name)||"Member"}),(0,c.jsxs)("div",{className:"member-info",children:[(0,c.jsx)("p",{children:(null===(l=e.user_id)||void 0===l?void 0:l.name)||"Unknown"}),e.role&&(0,c.jsx)("span",{className:"member-role",children:e.role})]})]},d)}))})})]})};const Y=function(e){let{event:t,orgId:s,onRefresh:r}=e;const{addNotification:o}=(0,l.l)(),[d,m]=(0,n.useState)(null),[u,h]=(0,n.useState)([]),[v,g]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[j,b]=(0,n.useState)(!1),[y,k]=(0,n.useState)(!1),[w,C]=(0,n.useState)(!1),[S,_]=(0,n.useState)({name:"",description:""}),[I,E]=(0,n.useState)(!0),[D,T]=(0,n.useState)({}),[R,O]=(0,n.useState)(!1),[J,A]=(0,n.useState)(null),[$,q]=(0,n.useState)(!1),[F,P]=(0,n.useState)(null),{data:Z,refetch:U}=(0,a.i)(null!==t&&void 0!==t&&t._id&&s?`/org-event-management/${s}/events/${t._id}/roles`:null),{data:z,refetch:W}=(0,a.i)(null!==t&&void 0!==t&&t._id&&s?`/org-event-management/${s}/events/${t._id}/volunteer-signups`:null),{data:Y}=(0,a.i)(s?`/org-event-management/${s}/event-roles`:null),{data:G}=(0,a.i)(s?`/org-roles/${s}/members`:null),K=(null===G||void 0===G?void 0:G.members)||[];(0,n.useEffect)((()=>{null!==Z&&void 0!==Z&&Z.success&&(h(Z.data.roles||[]),E(!1))}),[Z]),(0,n.useEffect)((()=>{null!==z&&void 0!==z&&z.success&&g(z.data.signups||[])}),[z]),(0,n.useEffect)((()=>{null!==Y&&void 0!==Y&&Y.success&&x(Y.data.roles||[])}),[Y]);const X=async e=>{if(null===t||void 0===t||!t._id||!s)return;const n=u.find((t=>{var s;return((null===(s=t.orgRoleId)||void 0===s?void 0:s._id)||t.orgRoleId)===e._id}));try{let i;if(i=n?await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/roles/${n._id}`,{requiredCount:(n.requiredCount||0)+1},{method:"PUT"}):await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/roles`,{orgRoleId:e._id,requiredCount:1},{method:"POST"}),!i.success)throw new Error(i.message||"Failed to update job count");U(),r&&r()}catch(i){o({title:"Error",message:i.message||"Failed to update job count",type:"error"})}};return I?(0,c.jsxs)("div",{className:"roles-manager loading",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("p",{children:"Loading jobs..."})]}):(0,c.jsxs)("div",{className:"roles-manager",children:[(0,c.jsxs)("div",{className:"roles-header",children:[(0,c.jsxs)("div",{className:"header-left",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:account-group"}),"Event Jobs & Assignments"]}),(0,c.jsxs)("p",{children:[u.length," job",1!==u.length?"s":""," defined"]})]}),(0,c.jsxs)("div",{className:"header-actions",children:[(0,c.jsxs)("button",{className:"btn-secondary",onClick:()=>b(!0),children:[(0,c.jsx)(i.JO,{icon:"mdi:account-plus"}),(0,c.jsx)("span",{children:"Volunteer Signup"})]}),(0,c.jsxs)("button",{className:"btn-primary",onClick:()=>{0!==p.length?k(!0):o({title:"No Job Templates",message:"Create job templates in Settings \u2192 Job Templates before assigning jobs to events.",type:"warning"})},disabled:0===p.length,children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),(0,c.jsx)("span",{children:"Add Job Slots"})]})]})]}),0===p.length&&(0,c.jsx)(L.Z,{icon:"mdi:information-outline",title:"No job templates available",description:"Create job templates in Settings \u2192 Job Templates to assign jobs to this event."}),0===u.length?(0,c.jsx)(L.Z,{icon:"mdi:account-group-outline",title:"No event jobs assigned yet",description:"Add event jobs to keep everyone organized."}):(0,c.jsx)("div",{className:"roles-list",children:u.map((e=>{var n,a;const l=(null===(n=e.assignments)||void 0===n?void 0:n.filter((e=>"confirmed"===e.status)).length)||0,u=l>=e.requiredCount;return(0,c.jsxs)("div",{className:"role-card "+(u?"fully-staffed":""),children:[(0,c.jsxs)("div",{className:"role-header",children:[(0,c.jsxs)("div",{className:"role-info",children:[(0,c.jsx)("h4",{children:e.name}),e.description&&(0,c.jsx)("p",{children:e.description})]}),(0,c.jsx)("div",{className:"role-actions",children:(0,c.jsx)("button",{className:"action-btn delete",onClick:()=>{return t=e._id,A(t),void O(!0);var t},title:"Delete Job",children:(0,c.jsx)(i.JO,{icon:"mdi:delete"})})})]}),e.shiftStart&&e.shiftEnd&&(0,c.jsx)("div",{className:"role-stats",children:(0,c.jsxs)("div",{className:"stat-item",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),(0,c.jsxs)("span",{children:[new Date(e.shiftStart).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})," -",new Date(e.shiftEnd).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]})}),(0,c.jsxs)("div",{className:"role-assignments",children:[(0,c.jsxs)("div",{className:"assignments-header",children:[(0,c.jsxs)("h5",{children:["Assignments (",l," / ",e.requiredCount,")"]}),!u&&(0,c.jsx)("div",{className:"member-selector",children:(0,c.jsx)(H,{members:K.filter((t=>{var s;const n=t.user_id._id.toString();return!(null!==(s=e.assignments)&&void 0!==s&&s.some((e=>{var t,s,i;return((null===(t=e.memberId)||void 0===t||null===(s=t._id)||void 0===s?void 0:s.toString())||(null===(i=e.memberId)||void 0===i?void 0:i.toString()))===n})))})),onMemberSelect:n=>{n&&(async(e,n)=>{var i;if(!n||null===t||void 0===t||!t._id||!s||null===e||void 0===e||!e._id)return;if(null===(i=e.assignments)||void 0===i?void 0:i.some((e=>{var t,s,i;return(null===(t=e.memberId)||void 0===t||null===(s=t._id)||void 0===s?void 0:s.toString())===n||(null===(i=e.memberId)||void 0===i?void 0:i.toString())===n})))o({title:"Already Assigned",message:"This member is already assigned to this job",type:"warning"});else{T((t=>({...t,[e._id]:!0})));try{const i=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/assignments`,{roleId:e._id,memberId:n,status:"confirmed"},{method:"POST"});if(!i.success)throw new Error(i.message||"Failed to assign member");U(),r&&r(),o({title:"Success",message:"Member assigned successfully",type:"success"})}catch(a){o({title:"Error",message:a.message||"Failed to assign member",type:"error"})}finally{T((t=>({...t,[e._id]:!1})))}}})(e,n)},disabled:D[e._id],placeholder:"Select member"})}),u&&(0,c.jsxs)("span",{className:"fully-staffed-badge",children:[(0,c.jsx)(i.JO,{icon:"mdi:check-circle"}),"Fully Staffed"]})]}),(0,c.jsxs)("div",{className:"assignments-list",children:[null===(a=e.assignments)||void 0===a?void 0:a.filter((e=>"confirmed"===e.status)).map(((t,s)=>{var n,a;return(0,c.jsxs)("div",{className:"assignment-item",children:[(0,c.jsxs)("div",{className:"member-info",children:[(0,c.jsx)("span",{className:"member-name",children:(null===(n=t.memberId)||void 0===n?void 0:n.name)||"Unknown"}),(null===(a=t.memberId)||void 0===a?void 0:a.email)&&(0,c.jsxs)("span",{className:"member-email clickable",onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),m(e),o({title:"Copied",message:"Email copied to clipboard",type:"success"}),setTimeout((()=>m(null)),2e3)}catch(t){o({title:"Error",message:"Failed to copy email",type:"error"})}})(t.memberId.email),title:"Click to copy email",children:[t.memberId.email,(0,c.jsx)(i.JO,{icon:d===t.memberId.email?"mdi:check":"mdi:content-copy",className:"copy-icon"})]})]}),(0,c.jsxs)("div",{className:"assignment-actions",children:[(0,c.jsx)("span",{className:`status-badge ${t.status||"confirmed"}`,children:t.status||"confirmed"}),(0,c.jsx)("button",{className:"remove-assignment-btn",onClick:()=>((e,t)=>{var s,n;const i=null===(s=e.assignments)||void 0===s?void 0:s.find((e=>e._id===t)),a=(null===i||void 0===i||null===(n=i.memberId)||void 0===n?void 0:n.name)||"this member";P({role:e,assignmentId:t,memberName:a}),q(!0)})(e,t._id),title:"Remove member",disabled:D[e._id],children:(0,c.jsx)(i.JO,{icon:"mdi:close"})})]})]},`assigned-${s}`)})),Array.from({length:Math.max(0,e.requiredCount-l)}).map(((e,t)=>(0,c.jsx)("div",{className:"assignment-item placeholder-slot",children:(0,c.jsxs)("div",{className:"member-info",children:[(0,c.jsx)(i.JO,{icon:"mdi:account-outline",className:"placeholder-icon"}),(0,c.jsx)("span",{className:"placeholder-text",children:"Open slot"})]})},`placeholder-${t}`)))]})]})]},e._id)}))}),(0,c.jsx)(B,{roles:u,event:t}),(0,c.jsx)(f.Z,{isOpen:y,onClose:()=>k(!1),customClassName:"job-picker-popup medium-content",defaultStyling:!1,hideCloseButton:!0,children:(0,c.jsx)(V,{orgRoles:p,roles:u,creatingJobTemplate:w,setCreatingJobTemplate:C,newJobTemplate:S,setNewJobTemplate:_,onCreateJobTemplate:async()=>{if(s&&S.name.trim())try{var e;const t=await(0,N.Z)(`/org-event-management/${s}/event-roles`,{name:S.name.trim(),description:S.description.trim()},{method:"POST"});if(!t.success)throw new Error(t.message||"Failed to create job template");const n=null===(e=t.data)||void 0===e?void 0:e.role;n&&(x((e=>[...e,n].sort(((e,t)=>e.name.localeCompare(t.name))))),_({name:"",description:""}),C(!1),await X(n))}catch(t){o({title:"Error",message:t.message||"Failed to create job template",type:"error"})}},onIncrementJob:X,onDecrementJob:async e=>{if(null===t||void 0===t||!t._id||!s)return;const n=u.find((t=>{var s;return((null===(s=t.orgRoleId)||void 0===s?void 0:s._id)||t.orgRoleId)===e._id}));if(n&&n.requiredCount)try{if(n.requiredCount<=1){const e=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/roles/${n._id}`,{},{method:"DELETE"});if(!e.success)throw new Error(e.message||"Failed to remove job")}else{const e=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/roles/${n._id}`,{requiredCount:n.requiredCount-1},{method:"PUT"});if(!e.success)throw new Error(e.message||"Failed to update job count")}U(),r&&r()}catch(i){o({title:"Error",message:i.message||"Failed to update job count",type:"error"})}},onClose:()=>k(!1)})}),(0,c.jsx)(f.Z,{isOpen:j,onClose:()=>b(!1),customClassName:"volunteer-signup-popup medium-content",defaultStyling:!1,hideCloseButton:!0,children:(0,c.jsx)(Q,{event:t,orgId:s,roles:u,onClose:()=>b(!1),onSuccess:()=>{W(),U(),r&&r()}})}),(0,c.jsx)(M.Z,{isOpen:R,onConfirm:async()=>{if(J&&null!==t&&void 0!==t&&t._id&&s)try{const e=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/roles/${J}`,{},{method:"DELETE"});if(!e.success)throw new Error(e.message||"Failed to delete job");h(u.filter((e=>e._id!==J))),U(),r&&r(),o({title:"Success",message:"Job deleted successfully",type:"success"})}catch(e){o({title:"Error",message:e.message||"Failed to delete job",type:"error"})}finally{O(!1),A(null)}},onCancel:()=>{O(!1),A(null)},title:"Delete Job",message:"Are you sure you want to delete this job? All assignments will be removed.",warningDetails:"All assigned members will be removed from this job."}),(0,c.jsx)(M.Z,{isOpen:$,onConfirm:async()=>{var e;if(!F||null===t||void 0===t||!t._id||!s||null===(e=F.role)||void 0===e||!e._id||!F.assignmentId)return;const{role:n,assignmentId:i}=F;T((e=>({...e,[n._id]:!0})));try{const e=await(0,N.Z)(`/org-event-management/${s}/events/${t._id}/assignments/${i}`,{},{method:"DELETE"});if(!e.success)throw new Error(e.message||"Failed to remove member");U(),r&&r(),o({title:"Success",message:"Member removed successfully",type:"success"})}catch(a){o({title:"Error",message:a.message||"Failed to remove member",type:"error"})}finally{T((e=>({...e,[n._id]:!1}))),q(!1),P(null)}},onCancel:()=>{q(!1),P(null)},title:"Remove Assignment",message:`Are you sure you want to remove ${(null===F||void 0===F?void 0:F.memberName)||"this member"} from this job?`,warningDetails:"The member will be unassigned from this job slot.",confirmLabel:"Remove"})]})};const G=function(e){let{event:t,orgId:s,onRefresh:r}=e;const{addNotification:o}=(0,l.l)(),[d,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[v,g]=(0,n.useState)(!1),{data:p,refetch:x}=(0,a.i)(null!==t&&void 0!==t&&t._id?`/event-analytics/event/${t._id}?timeRange=30d`:null);(0,n.useEffect)((()=>{null!==p&&void 0!==p&&p.success?(m(p.data),h(!1)):p&&!p.success&&h(!1)}),[p]),(0,n.useEffect)((()=>{const e=setInterval((()=>{x()}),3e4);return()=>clearInterval(e)}),[x]);const j=e=>(new Intl.NumberFormat).format(e);if(u)return(0,c.jsxs)("div",{className:"event-analytics-detail loading",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("p",{children:"Loading analytics..."})]});if(!d)return(0,c.jsxs)("div",{className:"event-analytics-detail error",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle"}),(0,c.jsx)("p",{children:"Failed to load analytics"})]});const b=d.registrationHistory||[],f=d.registrations||b.length||0,N=d.viewHistory||[],y=N.filter((e=>!e.isAnonymous&&e.userId)),k=y.length+N.filter((e=>e.isAnonymous)).length,w=d.views||0,C=d.anonymousViews||0,S=w+C,_=k>0?f/k*100:d.engagementRate||0,I=d.uniqueViews||0,E=d.uniqueRegistrations||0,D=I>0?(E/I*100).toFixed(1):0,T=I>0?(S/I).toFixed(1):0,R=new Date,O=new Date(R.getTime()-864e5),J=N.filter((e=>new Date(e.timestamp)>=O)).length,A=b.filter((e=>new Date(e.timestamp)>=O)).length;return(0,c.jsxs)("div",{className:"event-analytics-detail",children:[(0,c.jsxs)("div",{className:"analytics-header",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mingcute:chart-fill"}),"Event Analytics"]}),(0,c.jsxs)("div",{className:"live-indicator",children:[(0,c.jsx)("span",{className:"live-dot"}),(0,c.jsx)("span",{children:"Live"})]})]}),(0,c.jsxs)("div",{className:"analytics-grid",children:[(0,c.jsx)(z.Z,{icon:"mdi:eye",header:"Views",classN:"analytics-card",size:"1rem",children:(0,c.jsx)("div",{className:"card-content",children:(0,c.jsxs)("div",{className:"views-grid",children:[(0,c.jsxs)("div",{className:"views-squares-wrapper",children:[(0,c.jsx)("div",{className:"view-square-wrapper",children:(0,c.jsx)("div",{className:"view-square",children:(0,c.jsxs)("div",{className:"view-square-content",children:[(0,c.jsx)("span",{className:"view-value",children:j(w)}),(0,c.jsx)("span",{className:"view-label",children:"Logged-in"}),(0,c.jsxs)("span",{className:"view-subtitle",children:[j(d.uniqueViews||0)," unique"]})]})})}),(0,c.jsx)("div",{className:"view-square-wrapper",children:(0,c.jsx)("div",{className:"view-square",children:(0,c.jsxs)("div",{className:"view-square-content",children:[(0,c.jsx)("span",{className:"view-value",children:j(C)}),(0,c.jsx)("span",{className:"view-label",children:"Anonymous"}),(0,c.jsxs)("span",{className:"view-subtitle",children:[j(d.uniqueAnonymousViews||0)," unique"]})]})})})]}),(0,c.jsx)("div",{className:"view-total-wrapper",children:(0,c.jsx)("div",{className:"view-total",children:(0,c.jsxs)("div",{className:"view-total-content",children:[(0,c.jsx)("span",{className:"view-value",children:j(S)}),(0,c.jsx)("span",{className:"view-label",children:"Total Views"})]})})})]})})}),(0,c.jsx)(z.Z,{icon:"mingcute:trending-up-fill",header:"Engagement",classN:"analytics-card",size:"1rem",children:(0,c.jsxs)("div",{className:"card-content",children:[(0,c.jsxs)("div",{className:"stat-large",children:[(0,c.jsxs)("span",{className:"stat-value",children:[_.toFixed(1),"%"]}),(0,c.jsx)("span",{className:"stat-label",children:"Engagement Rate"})]}),(0,c.jsx)("div",{className:"engagement-bar-container",children:(0,c.jsx)("div",{className:"engagement-bar",children:(0,c.jsx)("div",{className:"engagement-fill",style:{width:`${Math.min(_,100)}%`}})})}),(0,c.jsx)("div",{className:"rsvp-segments-display",children:(0,c.jsxs)("div",{className:"rsvp-segment-item going",children:[(0,c.jsx)("span",{className:"segment-number",children:f}),(0,c.jsx)("span",{className:"segment-label",children:"Registrations"})]})})]})}),(0,c.jsx)(z.Z,{icon:"mingcute:chart-line-fill",header:"Conversion & Activity",classN:"analytics-card",size:"1rem",children:(0,c.jsxs)("div",{className:"card-content",children:[(0,c.jsxs)("div",{className:"conversion-metrics",children:[(0,c.jsxs)("div",{className:"conversion-item",children:[(0,c.jsxs)("div",{className:"conversion-value",children:[D,"%"]}),(0,c.jsx)("div",{className:"conversion-label",children:"View-to-Registration"}),(0,c.jsx)("div",{className:"conversion-subtitle",children:"Unique conversion rate"})]}),(0,c.jsxs)("div",{className:"conversion-item",children:[(0,c.jsx)("div",{className:"conversion-value",children:f}),(0,c.jsx)("div",{className:"conversion-label",children:"Registrations"}),(0,c.jsx)("div",{className:"conversion-subtitle",children:"Total registered"})]}),(0,c.jsxs)("div",{className:"conversion-item",children:[(0,c.jsx)("div",{className:"conversion-value",children:T}),(0,c.jsx)("div",{className:"conversion-label",children:"Avg Views/User"}),(0,c.jsx)("div",{className:"conversion-subtitle",children:"Per unique viewer"})]})]}),(0,c.jsxs)("div",{className:"recent-activity",children:[(0,c.jsxs)("div",{className:"activity-header",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),(0,c.jsx)("span",{children:"Last 24 Hours"})]}),(0,c.jsxs)("div",{className:"activity-stats",children:[(0,c.jsxs)("div",{className:"activity-stat",children:[(0,c.jsx)("span",{className:"activity-value",children:J}),(0,c.jsx)("span",{className:"activity-label",children:"Views"})]}),(0,c.jsxs)("div",{className:"activity-stat",children:[(0,c.jsx)("span",{className:"activity-value",children:A}),(0,c.jsx)("span",{className:"activity-label",children:"Registrations"})]})]})]})]})})]}),y.length>0&&(0,c.jsx)(z.Z,{icon:"mingcute:eye-fill",header:"Logged-in Views",classN:"logged-in-views-section",size:"1.25rem",children:(0,c.jsxs)("div",{className:"logged-in-views-list",children:[y.slice(0,20).map(((e,t)=>{return(0,c.jsxs)("div",{className:"history-item",children:[(0,c.jsx)("div",{className:"history-icon",children:(0,c.jsx)(i.JO,{icon:"mingcute:eye-fill"})}),(0,c.jsxs)("div",{className:"history-content",children:[(0,c.jsx)("p",{className:"history-time",children:(s=e.timestamp,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))}),(0,c.jsx)("p",{className:"history-detail",children:"User viewed this event"})]})]},t);var s})),y.length>20&&(0,c.jsx)("div",{className:"views-more",children:(0,c.jsxs)("span",{children:["+",y.length-20," more views"]})})]})})]})};const K=function(e){let{qrCode:t,eventName:s}=e;const[a,l]=(0,n.useState)(!1);return(0,c.jsxs)("div",{className:"qr-code-display",children:[(0,c.jsx)("div",{className:"qr-code-image-container",children:(0,c.jsx)("img",{src:t,alt:"Check-in QR Code",className:"qr-code-image"})}),(0,c.jsxs)("div",{className:"qr-code-actions",children:[(0,c.jsxs)("button",{className:"action-button",onClick:()=>{const e=document.createElement("a");e.href=t,e.download=`${s||"event"}-checkin-qr.png`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},children:[(0,c.jsx)(i.JO,{icon:"mdi:download"}),"Download"]}),(0,c.jsxs)("button",{className:"action-button",onClick:async()=>{if(navigator.share)try{await navigator.share({title:`Check-in QR Code - ${s}`,text:`Scan this QR code to check in to ${s}`,files:[await fetch(t).then((e=>e.blob()))]})}catch(e){"AbortError"!==e.name&&console.error("Error sharing QR code:",e)}else try{const e=await fetch(t),s=await e.blob();await navigator.clipboard.write([new ClipboardItem({"image/png":s})]),l(!0),setTimeout((()=>l(!1)),2e3)}catch(e){console.error("Error copying QR code:",e)}},children:[(0,c.jsx)(i.JO,{icon:a?"mdi:check":"mdi:share"}),a?"Copied!":"Share"]})]})]})};const X=function(e){let{checkInUrl:t,eventName:s}=e;const[a,l]=(0,n.useState)(!1),r=async()=>{try{await navigator.clipboard.writeText(t),l(!0),setTimeout((()=>l(!1)),2e3)}catch(e){console.error("Error copying link:",e);const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),l(!0),setTimeout((()=>l(!1)),2e3)}};return(0,c.jsxs)("div",{className:"checkin-link-display",children:[(0,c.jsx)("div",{className:"link-container",children:(0,c.jsx)("input",{type:"text",value:t,readOnly:!0,className:"link-input",onClick:e=>e.target.select()})}),(0,c.jsxs)("div",{className:"link-actions",children:[(0,c.jsxs)("button",{className:"action-button",onClick:r,children:[(0,c.jsx)(i.JO,{icon:a?"mdi:check":"mdi:content-copy"}),a?"Copied!":"Copy"]}),(0,c.jsxs)("button",{className:"action-button",onClick:async()=>{if(navigator.share)try{await navigator.share({title:`Check-in Link - ${s}`,text:`Check in to ${s}`,url:t})}catch(e){"AbortError"!==e.name&&console.error("Error sharing link:",e)}else r()},children:[(0,c.jsx)(i.JO,{icon:"mdi:share"}),"Share"]})]})]})};var ee=s(63130);const te=function(e){let{attendees:t,onManualCheckIn:s,onRemoveCheckIn:a,onOpenManualCheckInModal:l}=e;const[r,o]=(0,n.useState)(""),[d,m]=(0,n.useState)("all"),u=(0,n.useMemo)((()=>{let e=t;if(r){const t=r.toLowerCase();e=e.filter((e=>{const s=e.userId;return((null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.username)||"Unknown").toLowerCase().includes(t)}))}return"self"===d?e=e.filter((e=>!e.checkedInBy)):"manual"===d&&(e=e.filter((e=>e.checkedInBy))),e}),[t,r,d]),h=e=>{if(!e)return"Unknown";try{return(0,ee.Q)(new Date(e),{addSuffix:!0})}catch(t){return"Unknown"}},v=e=>{const t=e.userId;return(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t?void 0:t.username)||"Unknown User"},g=e=>{const t=e.userId;return(null===t||void 0===t?void 0:t.picture)||null};return 0===t.length?(0,c.jsxs)("div",{className:"checkin-list-empty",children:[(0,c.jsx)(i.JO,{icon:"mdi:account-off"}),(0,c.jsx)("p",{children:"No attendees have checked in yet."})]}):(0,c.jsxs)("div",{className:"checkin-list",children:[(0,c.jsxs)("div",{className:"checkin-list-controls",children:[(0,c.jsxs)("div",{className:"search-input-wrapper",children:[(0,c.jsx)(i.JO,{icon:"mdi:magnify",className:"search-icon"}),(0,c.jsx)("input",{type:"text",placeholder:"Search attendees...",value:r,onChange:e=>o(e.target.value),className:"search-input"})]}),(0,c.jsxs)("div",{className:"filter-buttons",children:[(0,c.jsx)("button",{className:"filter-button "+("all"===d?"active":""),onClick:()=>m("all"),children:"All"}),(0,c.jsx)("button",{className:"filter-button "+("self"===d?"active":""),onClick:()=>m("self"),children:"Self Check-In"}),(0,c.jsx)("button",{className:"filter-button "+("manual"===d?"active":""),onClick:()=>m("manual"),children:"Manual"})]})]}),(0,c.jsx)("div",{className:"attendees-list",children:0===u.length?(0,c.jsxs)("div",{className:"checkin-list-empty",children:[(0,c.jsx)(i.JO,{icon:"mdi:magnify"}),(0,c.jsx)("p",{children:"No attendees match your search."})]}):u.map(((e,t)=>{const s=e.userId,n=e.checkedInBy,l=!!n,r=s&&(s._id||s.id)?String(s._id||s.id):null;return(0,c.jsxs)("div",{className:"attendee-item",children:[(0,c.jsxs)("div",{className:"attendee-info",children:[(0,c.jsx)("div",{className:"attendee-avatar",children:g(e)?(0,c.jsx)("img",{src:g(e),alt:v(e)}):(0,c.jsx)(i.JO,{icon:"mdi:account-circle"})}),(0,c.jsxs)("div",{className:"attendee-details",children:[(0,c.jsx)("div",{className:"attendee-name",children:v(e)}),(0,c.jsxs)("div",{className:"attendee-meta",children:[(0,c.jsxs)("span",{className:"checkin-time",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),h(e.checkedInAt)]}),(0,c.jsxs)("span",{className:"checkin-method "+(l?"manual":"self"),children:[(0,c.jsx)(i.JO,{icon:l?"mdi:account-check":"mdi:qrcode-scan"}),l?"Manual":"Self Check-In"]})]})]})]}),(0,c.jsxs)("div",{className:"attendee-actions",children:[l&&n&&(0,c.jsxs)("div",{className:"checked-in-by",children:["Checked in by ",(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.username)||"Organizer"]}),a&&r&&(0,c.jsxs)("button",{type:"button",className:"remove-checkin-btn",onClick:()=>a(r),title:"Remove check-in",children:[(0,c.jsx)(i.JO,{icon:"mdi:logout"}),"Remove"]})]})]},t)}))}),s&&l&&(0,c.jsx)("div",{className:"manual-checkin-section",children:(0,c.jsxs)("button",{type:"button",className:"manual-checkin-button",onClick:l,children:[(0,c.jsx)(i.JO,{icon:"mdi:account-plus"}),"Manually Check In Attendee"]})})]})};var se=s(96127),ne=s(64885);const ie=function(e){var t,s,r,o,d,m,u;let{event:h,orgId:v,onRefresh:g,isTabActive:p=!1}=e;const{addNotification:x}=(0,l.l)(),[j,b]=(0,n.useState)(!1),[y,k]=(0,n.useState)(null),[w,C]=(0,n.useState)(null),[S,_]=(0,n.useState)([]),[I,E]=(0,n.useState)(null),[D,T]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1),[J,A]=(0,n.useState)(!1),{data:$,refetch:q}=(0,a.i)(null!==h&&void 0!==h&&h.checkInEnabled&&("qr"===(null===h||void 0===h||null===(t=h.checkInSettings)||void 0===t?void 0:t.method)||"both"===(null===h||void 0===h||null===(s=h.checkInSettings)||void 0===s?void 0:s.method))&&null!==h&&void 0!==h&&h._id&&v?`/events/${h._id}/check-in/qr`:null),{data:F,refetch:M}=(0,a.i)(null!==h&&void 0!==h&&h.checkInEnabled&&("link"===(null===h||void 0===h||null===(r=h.checkInSettings)||void 0===r?void 0:r.method)||"both"===(null===h||void 0===h||null===(o=h.checkInSettings)||void 0===o?void 0:o.method))&&null!==h&&void 0!==h&&h._id&&v?`/events/${h._id}/check-in/link`:null),{data:P,refetch:Z}=(0,a.i)(null!==h&&void 0!==h&&h.checkInEnabled&&null!==h&&void 0!==h&&h._id&&v?`/events/${h._id}/check-in/attendees`:null),{data:U,loading:B}=(0,a.i)(D&&null!==h&&void 0!==h&&h._id?`/attendees/${h._id}`:null),V=Boolean(p&&(null===h||void 0===h?void 0:h.checkInEnabled)&&(null===h||void 0===h?void 0:h._id));(0,ne.tG)(V?h._id:null,(()=>{null===Z||void 0===Z||Z(),null===g||void 0===g||g()})),(0,n.useEffect)((()=>{null!==$&&void 0!==$&&$.success&&k($.qrCode)}),[$]),(0,n.useEffect)((()=>{null!==F&&void 0!==F&&F.success&&C(F.checkInUrl)}),[F]),(0,n.useEffect)((()=>{null!==P&&void 0!==P&&P.success&&(_(P.attendees||[]),E(P.stats||null))}),[P]);const[Q,W]=(0,n.useState)(!1),H=async e=>{try{const t=await(0,N.Z)(`/events/${h._id}/check-in/${e}`,{},{method:"POST"});if(!t.success)throw new Error(t.message||"Failed to check in user");x({title:"Success",message:"User checked in successfully",type:"success"}),T(!1),await Z(),g&&g()}catch(t){x({title:"Error",message:t.message||"Failed to check in user",type:"error"})}},Y=e=>e.userId&&(e.userId._id||e.userId.id||e.userId)?String(e.userId._id||e.userId.id||e.userId):null,G=new Set((S||[]).map(Y).filter(Boolean)),ee=(null!==U&&void 0!==U&&U.success&&U.attendees||[]).filter((e=>{const t=Y(e);return t&&!G.has(t)}));if(!h)return(0,c.jsx)("div",{className:"event-checkin-tab",children:"Loading..."});const ie=async()=>{O(!0);try{const e=await(0,N.Z)(`/events/${h._id}/check-in/enable`,{},{method:"POST"});if(!e.success)throw new Error(e.message||"Failed to enable check-in");x({title:"Success",message:"Check-in is now enabled for this event.",type:"success"}),g&&g()}catch(e){x({title:"Error",message:e.message||"Failed to enable check-in",type:"error"})}finally{O(!1)}};if(!h.checkInEnabled)return(0,c.jsx)("div",{className:"event-checkin-tab",children:(0,c.jsx)(L.Z,{icon:"mdi:qrcode-scan",title:"Check-In Not Enabled",description:"Enable check-in to start tracking attendance with QR code, link, or manual check-in. You can change QR/link options in the Edit tab after enabling.",actions:(0,c.jsxs)("button",{type:"button",className:"enable-checkin-button",onClick:ie,disabled:R,children:[(0,c.jsx)(i.JO,{icon:R?"mdi:loading":"mdi:qrcode-scan",className:R?"spin":""}),R?"Enabling...":"Enable check-in"]})})});const ae=(null===(d=h.checkInSettings)||void 0===d?void 0:d.method)||"both",le="qr"===ae||"both"===ae,re="link"===ae||"both"===ae;return(0,c.jsxs)("div",{className:"event-checkin-tab",children:[(0,c.jsxs)("div",{className:"checkin-header",children:[(0,c.jsxs)("h2",{children:[(0,c.jsx)(i.JO,{icon:"mdi:qrcode-scan"}),"Event Check-In"]}),(0,c.jsxs)("div",{className:"checkin-header-actions",children:[(0,c.jsxs)("button",{type:"button",className:"disable-checkin-button",onClick:async()=>{if(null!==h&&void 0!==h&&h._id){A(!0);try{const e=await(0,N.Z)(`/events/${h._id}/check-in/disable`,{},{method:"POST"});if(!e.success)throw new Error(e.message||"Failed to disable check-in");x({title:"Success",message:"Check-in is now disabled for this event.",type:"success"}),g&&g()}catch(e){x({title:"Error",message:e.message||"Failed to disable check-in",type:"error"})}finally{A(!1)}}},disabled:J,title:"Turn off check-in for this event",children:[(0,c.jsx)(i.JO,{icon:J?"mdi:loading":"mdi:account-off",className:J?"spin":""}),J?"Disabling...":"Disable check-in"]}),(0,c.jsxs)("button",{className:"refresh-button",onClick:async()=>{b(!0);try{await Promise.all([q(),M(),Z()]),g&&g()}catch(e){console.error("Error refreshing check-in data:",e)}finally{b(!1)}},disabled:j,children:[(0,c.jsx)(i.JO,{icon:j?"mdi:loading":"mdi:refresh",className:j?"spin":""}),j?"Refreshing...":"Refresh"]})]})]}),I&&(0,c.jsxs)("div",{className:"checkin-stats",children:[(0,c.jsx)(se.Z,{title:"Checked In",value:I.totalCheckedIn,icon:"mdi:account-check",iconVariant:"approved"}),(0,c.jsx)(se.Z,{title:"Total Registrations",value:null!==(m=null!==(u=I.totalRegistrations)&&void 0!==u?u:I.totalRSVPs)&&void 0!==m?m:0,icon:"mdi:account-group"}),(0,c.jsx)(se.Z,{title:"Check-In Rate",value:`${I.checkInRate}%`,icon:"mdi:chart-line"})]}),(0,c.jsxs)("div",{className:"checkin-methods",children:[(le||re)&&(0,c.jsx)(z.Z,{icon:le?"mdi:qrcode":"mdi:link",header:le?"QR Code":"Check-in link",classN:"checkin-section checkin-section-qr",right:w?(0,c.jsxs)("button",{type:"button",className:"copy-checkin-link-btn",onClick:async()=>{if(w)try{await navigator.clipboard.writeText(w),W(!0),setTimeout((()=>W(!1)),2e3),x({title:"Copied",message:"Check-in link copied to clipboard",type:"success"})}catch(e){x({title:"Error",message:(null===e||void 0===e?void 0:e.message)||"Failed to copy link",type:"error"})}},title:"Copy check-in link",children:[(0,c.jsx)(i.JO,{icon:Q?"mdi:check":"mdi:link-variant"}),Q?"Copied":"Copy link"]}):re&&!w?(0,c.jsx)("span",{className:"checkin-link-loading",children:"Loading link\u2026"}):null,children:(0,c.jsx)("div",{className:"checkin-section-content",children:le?y?(0,c.jsx)(K,{qrCode:y,eventName:h.name}):(0,c.jsx)("div",{className:"loading-placeholder",children:"Loading QR code..."}):w?(0,c.jsx)(X,{checkInUrl:w,eventName:h.name}):(0,c.jsx)("div",{className:"loading-placeholder",children:"Loading link..."})})}),(0,c.jsx)(z.Z,{icon:"mdi:account-check",header:"Checked-In Attendees",subheader:(0,c.jsxs)("span",{children:[S.length," attendees"]}),classN:"checkin-section checkin-section-attendees",children:(0,c.jsx)("div",{className:"checkin-section-content",children:0===S.length?(0,c.jsx)(L.Z,{icon:"mdi:account-check-outline",title:"No attendees have checked in yet",description:"Checked-in attendees will appear here. You can manually check in someone from the list of registrations.",actions:(0,c.jsxs)("button",{type:"button",className:"manual-checkin-button",onClick:()=>T(!0),children:[(0,c.jsx)(i.JO,{icon:"mdi:account-plus"}),"Manually check in attendee"]})}):(0,c.jsx)(te,{attendees:S,onManualCheckIn:H,onRemoveCheckIn:async e=>{try{const t=await(0,N.Z)(`/events/${h._id}/check-out/${e}`,{},{method:"POST"});if(!t.success)throw new Error(t.message||"Failed to remove check-in");x({title:"Success",message:"Check-in removed",type:"success"}),await Z(),g&&g()}catch(t){x({title:"Error",message:t.message||"Failed to remove check-in",type:"error"})}},onOpenManualCheckInModal:()=>T(!0)})})})]}),(0,c.jsx)(f.Z,{isOpen:D,onClose:()=>T(!1),customClassName:"manual-checkin-modal",children:(0,c.jsxs)("div",{className:"manual-checkin-modal-content",children:[(0,c.jsxs)("h3",{children:[(0,c.jsx)(i.JO,{icon:"mdi:account-plus"}),"Manually Check In Attendee"]}),(0,c.jsx)("p",{className:"manual-checkin-modal-hint",children:"Select a registrant who has not checked in yet."}),B?(0,c.jsx)("p",{className:"manual-checkin-modal-loading",children:"Loading registrations..."}):0===ee.length?(0,c.jsx)("p",{className:"manual-checkin-modal-empty",children:"Everyone registered has already checked in."}):(0,c.jsx)("ul",{className:"manual-checkin-modal-list",children:ee.map((e=>{var t,s;const n=Y(e),i=(null===(t=e.userId)||void 0===t?void 0:t.name)||(null===(s=e.userId)||void 0===s?void 0:s.username)||"Unknown";return(0,c.jsx)("li",{children:(0,c.jsx)("button",{type:"button",className:"manual-checkin-modal-item",onClick:()=>H(n),children:i})},n)}))}),(0,c.jsx)("button",{type:"button",className:"manual-checkin-modal-close",onClick:()=>T(!1),children:"Cancel"})]})})]})},ae=[{id:"table",label:"Table",icon:"mdi:table"},{id:"cards",label:"Cards",icon:"mdi:card-multiple"},{id:"summary",label:"Summary",icon:"mdi:chart-bar"}];const le=function(e){var t,s;let{event:r,orgId:o,onRefresh:d}=e;const{addNotification:m}=(0,l.l)(),[u,h]=(0,n.useState)(!1),[v,g]=(0,n.useState)("table"),[p,x]=(0,n.useState)(null),[j,b]=(0,n.useState)(null),{data:y,loading:k,error:w,refetch:C}=(0,a.i)(null!==r&&void 0!==r&&r._id&&o?`/org-event-management/${o}/events/${r._id}/registration-responses`:null),{data:S,refetch:_}=(0,a.i)(o?`/org-event-management/${o}/forms`:null),I=null!==S&&void 0!==S&&S.success&&S.data||[],[E,D]=(0,n.useState)(!1),[T,R]=(0,n.useState)(null),{registrations:J=[],formResponses:A=[],registrationFormId:$}=(null===y||void 0===y?void 0:y.data)||{},q=Boolean($),F=q?I.find((e=>e._id===$)):null,M=(0,n.useMemo)((()=>{var e;const t=null===(e=A[0])||void 0===e?void 0:e.formSnapshot;return(null===t||void 0===t?void 0:t.questions)||[]}),[A]),P=(0,n.useMemo)((()=>{if(!q||!M.length||!A.length)return[];const e=A.length;return M.map(((t,s)=>{const n={};A.forEach((e=>{var t;const i=null===(t=e.answers)||void 0===t?void 0:t[s];if(void 0===i||null===i)return;const a=(Array.isArray(i)?i.join(", "):String(i).trim())||"(empty)";n[a]=(n[a]||0)+1}));const i="multiple_choice"===t.type||"select_multiple"===t.type,a=Object.entries(n).map((e=>{let[t,s]=e;return{answer:t,count:s}}));a.sort(((e,t)=>t.count-e.count));const l=a.reduce(((e,t)=>e+t.count),0);return{question:t,total:e,answered:l,entries:a,isChoice:i}}))}),[q,M,A]),Z=e=>{e&&navigator.clipboard.writeText(e).then((()=>m({title:"Copied",message:"Email copied to clipboard",type:"success"})),(()=>m({title:"Copy failed",message:"Could not copy to clipboard",type:"error"})))},U=e=>(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.username)||"\u2014",B=e=>e.submittedBy?U(e.submittedBy):e.guestName||"Guest",z=e=>{return e.submittedBy?(null===(t=e.submittedBy)||void 0===t?void 0:t.email)||"\u2014":e.guestEmail||e.guestUsername||"\u2014";var t};if(k)return(0,c.jsxs)("div",{className:"registrations-tab loading",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("p",{children:"Loading registrations..."})]});if(w||y&&!y.success)return(0,c.jsxs)("div",{className:"registrations-tab error",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle"}),(0,c.jsx)("p",{children:w||(null===y||void 0===y?void 0:y.message)||"Failed to load registrations"})]});const V=null!==(t=null===r||void 0===r?void 0:r.registrationCount)&&void 0!==t?t:J.length,Q=null!==(s=null===r||void 0===r?void 0:r.registrationEnabled)&&void 0!==s&&s;return(0,c.jsxs)("div",{className:"registrations-tab",children:[!Q&&(0,c.jsxs)("div",{className:"registrations-disabled-banner",children:[(0,c.jsxs)("div",{className:"registrations-disabled-content",children:[(0,c.jsx)(i.JO,{icon:"mdi:account-off",className:"disabled-icon"}),(0,c.jsxs)("div",{className:"disabled-text",children:[(0,c.jsx)("strong",{children:"Registration is disabled"}),(0,c.jsx)("p",{children:"Enable registration to allow attendees to register for this event."})]})]}),(0,c.jsxs)("button",{type:"button",className:"enable-registration-btn",onClick:async()=>{if(o&&null!==r&&void 0!==r&&r._id){h(!0);try{const e=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}`,{registrationEnabled:!0},{method:"PUT"});null!==e&&void 0!==e&&e.success?(m({title:"Registration enabled",message:"Registration is now enabled for this event",type:"success"}),null===d||void 0===d||d(),null===C||void 0===C||C()):m({title:"Enable failed",message:(null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||"Failed to enable registration",type:"error"})}catch(e){m({title:"Enable failed",message:(null===e||void 0===e?void 0:e.message)||"Failed to enable registration",type:"error"})}finally{h(!1)}}},disabled:u,children:[(0,c.jsx)(i.JO,{icon:u?"mdi:loading":"mdi:account-plus",className:u?"spin":""}),u?"Enabling...":"Enable Registration"]})]}),(0,c.jsxs)("div",{className:"registrations-tab-header",children:[(0,c.jsxs)("div",{className:"registrations-summary",children:[(0,c.jsx)("span",{className:"count",children:V}),(0,c.jsx)("span",{className:"label",children:"Registrations"}),Q&&(0,c.jsxs)("span",{className:"registration-status-badge",children:[(0,c.jsx)(i.JO,{icon:"mdi:check-circle"}),"Enabled"]})]}),(0,c.jsxs)("div",{className:"registrations-tab-actions",children:[Q&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("button",{type:"button",className:"disable-registration-btn",onClick:async()=>{if(o&&null!==r&&void 0!==r&&r._id){h(!0);try{const e=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}`,{registrationEnabled:!1},{method:"PUT"});null!==e&&void 0!==e&&e.success?(m({title:"Registration disabled",message:"Registration is now disabled for this event",type:"success"}),null===d||void 0===d||d(),null===C||void 0===C||C()):m({title:"Disable failed",message:(null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||"Failed to disable registration",type:"error"})}catch(e){m({title:"Disable failed",message:(null===e||void 0===e?void 0:e.message)||"Failed to disable registration",type:"error"})}finally{h(!1)}}},disabled:u,title:"Disable registration",children:[(0,c.jsx)(i.JO,{icon:u?"mdi:loading":"mdi:account-off",className:u?"spin":""}),u?"Disabling...":"Disable"]}),(0,c.jsxs)("button",{type:"button",className:"copy-registration-link-btn",onClick:async()=>{if(null===r||void 0===r||!r._id)return;const e=`${window.location.origin}/event/${r._id}`;try{await navigator.clipboard.writeText(e),m({title:"Copied",message:"Registration link copied to clipboard",type:"success"})}catch{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select();try{document.execCommand("copy"),m({title:"Copied",message:"Registration link copied to clipboard",type:"success"})}catch{m({title:"Copy failed",message:"Could not copy link to clipboard",type:"error"})}document.body.removeChild(t)}},title:"Copy registration link",children:[(0,c.jsx)(i.JO,{icon:"mdi:link-variant"}),"Copy Link"]})]}),q&&A.length>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"view-mode-toggle",role:"tablist",children:ae.map((e=>(0,c.jsxs)("button",{type:"button",role:"tab","aria-selected":v===e.id,className:v===e.id?"active":"",onClick:()=>g(e.id),title:e.label,children:[(0,c.jsx)(i.JO,{icon:e.icon}),(0,c.jsx)("span",{children:e.label})]},e.id)))}),(0,c.jsxs)("button",{type:"button",className:"export-csv-btn",onClick:()=>{var e;const t=["Name","Email","Registered At",...M.map((e=>e.question||""))],s=A.map((e=>[B(e),z(e),e.submittedAt?new Date(e.submittedAt).toLocaleString():"",...(e.answers||[]).map((e=>Array.isArray(e)?e.join("; "):String(e)))])),n=[t.join(","),...s.map((e=>e.map((e=>`"${String(e).replace(/"/g,'""')}"`)).join(",")))].join("\n"),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(i),a.download=`registrations-${(null===r||void 0===r||null===(e=r.name)||void 0===e?void 0:e.replace(/\W/g,"-"))||(null===r||void 0===r?void 0:r._id)}.csv`,a.click(),URL.revokeObjectURL(a.href)},children:[(0,c.jsx)(i.JO,{icon:"mdi:download"}),"Export CSV"]})]})]})]}),(0,c.jsxs)("div",{className:"registrations-form-selector",children:[q?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"registrations-form-info",children:[(0,c.jsxs)("div",{className:"registrations-form-info-content",children:[(0,c.jsx)("label",{children:"Registration form"}),(0,c.jsx)("span",{className:"form-title",children:(null===F||void 0===F?void 0:F.title)||"Untitled Form"})]}),(0,c.jsxs)("div",{className:"registrations-form-actions",children:[(0,c.jsxs)("button",{type:"button",className:"edit-form-btn",onClick:()=>{R($),D(!0)},disabled:u,children:[(0,c.jsx)(i.JO,{icon:"mdi:pencil"}),"Edit"]}),(0,c.jsxs)("button",{type:"button",className:"delete-form-btn",onClick:async()=>{if(o&&null!==r&&void 0!==r&&r._id){h(!0);try{const e=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}`,{registrationFormId:null},{method:"PUT"});null!==e&&void 0!==e&&e.success?(m({title:"Form removed",message:"Registration form has been removed from this event",type:"success"}),null===d||void 0===d||d(),null===C||void 0===C||C()):m({title:"Remove failed",message:(null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||"Failed to remove form",type:"error"})}catch(e){m({title:"Remove failed",message:(null===e||void 0===e?void 0:e.message)||"Failed to remove registration form",type:"error"})}finally{h(!1)}}},disabled:u,children:[(0,c.jsx)(i.JO,{icon:u?"mdi:loading":"mdi:delete-outline",className:u?"spin":""}),"Delete"]})]})]}),u&&(0,c.jsxs)("span",{className:"registrations-form-selector-saving",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spin"}),"Saving\u2026"]})]}):(0,c.jsxs)("div",{className:"registrations-form-empty",children:[(0,c.jsxs)("div",{className:"registrations-form-empty-content",children:[(0,c.jsx)(i.JO,{icon:"mdi:form-select",className:"empty-icon"}),(0,c.jsxs)("div",{className:"empty-text",children:[(0,c.jsx)("label",{children:"Registration form"}),(0,c.jsx)("p",{children:"Create a registration form to collect information from attendees when they register for this event."})]})]}),(0,c.jsxs)("button",{type:"button",className:"create-form-btn",onClick:()=>{R(null),D(!0)},children:[(0,c.jsx)(i.JO,{icon:"mdi:plus"}),"Create form"]})]}),E&&(0,c.jsx)(O.Z,{orgId:o,formId:T||void 0,initialForm:T?I.find((e=>e._id===T)):void 0,onCreated:async e=>{if(null===_||void 0===_||_(),!T&&null!==r&&void 0!==r&&r._id&&o){h(!0);try{const t=await(0,N.Z)(`/org-event-management/${o}/events/${r._id}`,{registrationFormId:e},{method:"PUT"});null!==t&&void 0!==t&&t.success&&(m({title:"Form created",message:"The registration form is now active for this event.",type:"success"}),null===d||void 0===d||d(),null===C||void 0===C||C())}catch(t){m({title:"Form created",message:"There was an issue linking the form to the event.",type:"warning"})}finally{h(!1)}}else T&&(null===d||void 0===d||d(),null===C||void 0===C||C())},onClose:()=>{D(!1),R(null)}})]}),q&&A.length>0?(0,c.jsxs)(c.Fragment,{children:["table"===v&&(0,c.jsx)("div",{className:"registrations-table-wrapper",children:(0,c.jsxs)("table",{className:"registrations-table",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Name"}),(0,c.jsx)("th",{children:"Email"}),(0,c.jsx)("th",{children:"Submitted"}),M.map(((e,t)=>(0,c.jsx)("th",{children:e.question||`Q${t+1}`},t))),(0,c.jsx)("th",{className:"th-actions",children:"Actions"})]})}),(0,c.jsx)("tbody",{children:A.map(((e,t)=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:B(e)}),(0,c.jsx)("td",{children:z(e)}),(0,c.jsx)("td",{children:e.submittedAt?new Date(e.submittedAt).toLocaleString():"\u2014"}),(e.answers||[]).map(((e,t)=>(0,c.jsx)("td",{children:Array.isArray(e)?e.join(", "):String(null!==e&&void 0!==e?e:"\u2014")},t))),(0,c.jsxs)("td",{className:"td-actions",children:[(0,c.jsx)("button",{type:"button",className:"action-btn copy-email",onClick:()=>{var t;return Z((null===(t=e.submittedBy)||void 0===t?void 0:t.email)||e.guestEmail)},title:"Copy email",children:(0,c.jsx)(i.JO,{icon:"mdi:email-outline"})}),(0,c.jsx)("button",{type:"button",className:"action-btn remove",onClick:()=>b({responseId:e._id,name:B(e)}),title:"Remove registration",disabled:p===e._id,children:(0,c.jsx)(i.JO,{icon:p===e._id?"mdi:loading":"mdi:account-minus",className:p===e._id?"spin":""})})]})]},e._id||t)))})]})}),"cards"===v&&(0,c.jsx)("div",{className:"registrations-cards",children:A.map(((e,t)=>(0,c.jsxs)("div",{className:"registration-card",children:[(0,c.jsxs)("div",{className:"registration-card-header",children:[(0,c.jsxs)("div",{className:"registration-card-user",children:[(0,c.jsx)("span",{className:"name",children:B(e)}),(0,c.jsx)("span",{className:"email",children:z(e)})]}),(0,c.jsx)("div",{className:"registration-card-meta",children:e.submittedAt?new Date(e.submittedAt).toLocaleString():"\u2014"}),(0,c.jsxs)("div",{className:"registration-card-actions",children:[(0,c.jsx)("button",{type:"button",className:"action-btn copy-email",onClick:()=>{var t;return Z((null===(t=e.submittedBy)||void 0===t?void 0:t.email)||e.guestEmail)},title:"Copy email",children:(0,c.jsx)(i.JO,{icon:"mdi:email-outline"})}),(0,c.jsx)("button",{type:"button",className:"action-btn remove",onClick:()=>b({responseId:e._id,name:B(e)}),title:"Remove registration",disabled:p===e._id,children:(0,c.jsx)(i.JO,{icon:p===e._id?"mdi:loading":"mdi:account-minus",className:p===e._id?"spin":""})})]})]}),(0,c.jsx)("div",{className:"registration-card-answers",children:(e.answers||[]).map(((e,t)=>{var s;return(0,c.jsxs)("div",{className:"registration-card-answer",children:[(0,c.jsx)("span",{className:"q",children:(null===(s=M[t])||void 0===s?void 0:s.question)||`Q${t+1}`}),(0,c.jsx)("span",{className:"a",children:Array.isArray(e)?e.join(", "):String(null!==e&&void 0!==e?e:"\u2014")})]},t)}))})]},e._id||t)))}),"summary"===v&&(0,c.jsxs)("div",{className:"registrations-summary-view",children:[(0,c.jsxs)("p",{className:"summary-intro",children:[A.length," response",1!==A.length?"s":""," \u2014 breakdown by question"]}),P.map(((e,t)=>{var s;return(0,c.jsxs)("div",{className:"summary-question-block",children:[(0,c.jsx)("h4",{className:"summary-question-title",children:(null===(s=e.question)||void 0===s?void 0:s.question)||`Question ${t+1}`}),(0,c.jsxs)("p",{className:"summary-question-meta",children:[e.answered," of ",e.total," answered"]}),e.isChoice?(0,c.jsx)("div",{className:"summary-bars",children:e.entries.map((t=>{let{answer:s,count:n}=t;const i=e.answered?Math.round(n/e.answered*100):0;return(0,c.jsxs)("div",{className:"summary-bar-row",children:[(0,c.jsx)("span",{className:"summary-bar-label",title:s,children:s}),(0,c.jsx)("div",{className:"summary-bar-track",children:(0,c.jsx)("div",{className:"summary-bar-fill",style:{width:`${i}%`}})}),(0,c.jsx)("span",{className:"summary-bar-count",children:n})]},s)}))}):(0,c.jsx)("div",{className:"summary-text-responses",children:0===e.entries.length?(0,c.jsx)("span",{className:"summary-no-answers",children:"No answers"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("ul",{className:"summary-text-list",children:e.entries.slice(0,6).map((e=>{let{answer:t,count:s}=e;return(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{className:"summary-text-answer",children:t.length>100?`${t.slice(0,100)}\u2026`:t}),s>1&&(0,c.jsxs)("span",{className:"summary-text-count",children:["\xd7",s]})]},t)}))}),e.entries.length>6&&(0,c.jsxs)("p",{className:"summary-text-more",children:["+",e.entries.length-6," other answers \u2014 see Table or Cards for full list"]})]})})]},t)}))]})]}):(0,c.jsx)("div",{className:"registrations-list-simple",children:0===J.length?(0,c.jsx)(L.Z,{icon:"mdi:account-group-outline",title:"No registrations yet",description:"Registrations will appear here once people sign up for this event."}):(0,c.jsx)("ul",{children:J.map(((e,t)=>{var s,n;const a=(null===(s=e.userId)||void 0===s?void 0:s._id)||e.userId,l=(null===a||void 0===a||null===(n=a.toString)||void 0===n?void 0:n.call(a))||a;return(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{className:"user",children:U("object"===typeof e.userId?e.userId:null)}),(0,c.jsxs)("span",{className:"meta",children:[e.registeredAt?new Date(e.registeredAt).toLocaleDateString():"",e.guestCount>1?` \xb7 ${e.guestCount} guests`:"",e.checkedIn?" \xb7 Checked in":""]}),(0,c.jsxs)("span",{className:"list-actions",children:[(0,c.jsx)("button",{type:"button",className:"action-btn copy-email",onClick:()=>{var t;return Z(null===(t=e.userId)||void 0===t?void 0:t.email)},title:"Copy email",children:(0,c.jsx)(i.JO,{icon:"mdi:email-outline"})}),(0,c.jsx)("button",{type:"button",className:"action-btn remove",onClick:()=>b({userId:l,name:U(e.userId)}),title:"Remove registration",disabled:p===l,children:(0,c.jsx)(i.JO,{icon:p===l?"mdi:loading":"mdi:account-minus",className:p===l?"spin":""})})]})]},l||t)}))})}),j&&(0,c.jsx)(f.Z,{isOpen:!0,onClose:()=>b(null),customClassName:"registrations-confirm-remove-modal",children:(0,c.jsxs)("div",{className:"registrations-confirm-remove-inner",children:[(0,c.jsx)("h3",{children:"Remove registration?"}),(0,c.jsxs)("p",{children:["This will remove ",(0,c.jsx)("strong",{children:j.name})," from the event. They will need to register again to rejoin."]}),(0,c.jsxs)("div",{className:"registrations-confirm-remove-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>b(null),children:"Cancel"}),(0,c.jsx)("button",{type:"button",className:"btn-remove",onClick:()=>(async e=>{const{responseId:t,userId:s}=e||{},n=t||s;if(o&&null!==r&&void 0!==r&&r._id&&n){x(n);try{const e=t?`/org-event-management/${o}/events/${r._id}/registration-responses/${t}`:`/org-event-management/${o}/events/${r._id}/registrations/${s}`,n=await(0,N.Z)(e,null,{method:"DELETE"});null!==n&&void 0!==n&&n.success?(m({title:"Removed",message:"Registration removed",type:"success"}),b(null),null===d||void 0===d||d(),null===C||void 0===C||C()):m({title:"Remove failed",message:(null===n||void 0===n?void 0:n.message)||(null===n||void 0===n?void 0:n.error)||"Failed to remove",type:"error"})}catch(i){m({title:"Remove failed",message:(null===i||void 0===i?void 0:i.message)||"Failed to remove",type:"error"})}finally{x(null)}}})(j),disabled:null!=p,children:p?"Removing\u2026":"Remove"})]})]})})]})};const re=function(e){let{feature:t="Feature",description:s}=e;const n=s||{Communications:"Send messages and reminders to volunteers and attendees. Manage all event communications from one place.",Outreach:"Send messages and reminders to volunteers and attendees. Manage all event communications from one place.",Equipment:"Track equipment checkout, returns, and inventory for your event. Manage all equipment needs from one place."}[t]||"This feature is currently under development.";return(0,c.jsx)("div",{className:"coming-soon-container",children:(0,c.jsxs)("div",{className:"coming-soon-content",children:[(0,c.jsx)("div",{className:"coming-soon-icon",children:(0,c.jsx)(i.JO,{icon:"mdi:rocket-launch-outline"})}),(0,c.jsx)("h3",{children:"Coming Soon"}),(0,c.jsx)("h4",{children:t}),(0,c.jsx)("p",{children:n}),(0,c.jsxs)("div",{className:"coming-soon-badge",children:[(0,c.jsx)(i.JO,{icon:"mdi:clock-outline"}),(0,c.jsx)("span",{children:"In Development"})]})]})})};const oe=function(e){let{event:t,orgId:s,onClose:d,className:u=""}=e;const{addNotification:h}=(0,l.l)(),{AtlasMain:v}=(0,r.Q)(),[g,x]=(0,n.useState)(null),[j,b]=(0,n.useState)(!0),[f,N]=(0,n.useState)(0),[y,k]=(0,n.useState)("overview"),{data:w,loading:C,error:S,refetch:_}=(0,a.i)(null!==t&&void 0!==t&&t._id&&s?`/org-event-management/${s}/events/${t._id}/dashboard`:null);(0,n.useEffect)((()=>{null!==w&&void 0!==w&&w.success?(x(w.data),b(!1)):S||w&&!w.success?(h({title:"Error",message:S||(null===w||void 0===w?void 0:w.message)||"Failed to load event dashboard",type:"error"}),b(!1)):C&&b(!0)}),[w,S,C,h]),(0,n.useEffect)((()=>{f>0&&_()}),[f,_]);const I=()=>{N((e=>e+1))},E=(0,n.useRef)(null),D=(0,n.useRef)({spacer:null,tabsWrapper:null}),T=(0,n.useCallback)((()=>{const e=E.current;if(!e)return;const t=e.closest(".dashboard-overlay")||e.parentElement,s=e.querySelector(".tabbed-container__tabs-wrapper");if(!t||!s)return;const n=t.getBoundingClientRect(),i=D.current.spacer;if("fixed"===s.style.position&&i&&"none"!==i.style.display){i.getBoundingClientRect().top>n.top&&(s.style.position="",s.style.top="",s.style.left="",s.style.width="",s.style.zIndex="",s.style.background="",s.style.borderBottom="",i.style.display="none",i.style.height="0")}else{const e=s.getBoundingClientRect();if(e.top<=n.top){let t=D.current.spacer;t||(t=document.createElement("div"),t.className="event-dashboard-tabs-sticky-spacer",s.parentNode.insertBefore(t,s),D.current.spacer=t),t.style.height=`${e.height}px`,t.style.display="block",s.style.position="fixed",s.style.top=`${n.top}px`,s.style.left=`calc(${n.left}px + 1.5rem)`,s.style.width=`${n.width}px`,s.style.zIndex="100",s.style.background="var(--background)",s.style.borderBottom="1px solid var(--lighterborder)"}}}),[]);if((0,n.useEffect)((()=>{if(j||!g)return;const e=E.current;if(!e)return;const t=e.closest(".dashboard-overlay")||e.parentElement,s=e.querySelector(".tabbed-container__tabs-wrapper");if(!t||!s)return;const n=()=>{requestAnimationFrame(T)};return T(),t.addEventListener("scroll",n,{passive:!0}),window.addEventListener("resize",n),()=>{t.removeEventListener("scroll",n),window.removeEventListener("resize",n);const{spacer:e}=D.current;e&&e.parentNode&&e.parentNode.removeChild(e),s&&(s.style.position="",s.style.top="",s.style.left="",s.style.width="",s.style.zIndex="",s.style.background="",s.style.borderBottom="")}}),[j,g,T]),j)return(0,c.jsx)("div",{className:`event-dashboard ${u}`,children:(0,c.jsxs)("div",{className:"loading-container",children:[(0,c.jsx)(i.JO,{icon:"mdi:loading",className:"spinner"}),(0,c.jsx)("p",{children:"Loading event dashboard..."})]})});if(!g)return(0,c.jsx)("div",{className:`event-dashboard ${u}`,children:(0,c.jsxs)("div",{className:"error-container",children:[(0,c.jsx)(i.JO,{icon:"mdi:alert-circle"}),(0,c.jsx)("p",{children:"Failed to load event dashboard"}),(0,c.jsx)("button",{onClick:d,children:"Close"})]})});const R=[{id:"overview",label:"Overview",icon:"mingcute:chart-bar-fill",description:"Event statistics and quick actions",content:(0,c.jsx)(p,{event:g.event,stats:g.stats,agenda:g.agenda,roles:g.roles,equipment:g.equipment,orgId:s,onRefresh:I})},{id:"agenda",label:"Agenda",icon:"mdi:calendar-clock",description:"Build and manage event agenda",content:(0,c.jsx)(U,{event:g.event,orgId:s,onRefresh:I,isTabActive:"agenda"===y})},{id:"jobs",label:"Jobs",icon:"mdi:briefcase",description:"Manage event jobs and assignments",content:(0,c.jsx)(Y,{event:g.event,orgId:s,onRefresh:I})},{id:"analytics",label:"Analytics",icon:"mingcute:chart-line-fill",description:"Detailed event analytics and insights",content:(0,c.jsx)(G,{event:g.event,orgId:s,onRefresh:I})},{id:"edit",label:"Edit",icon:"mdi:pencil",description:"Edit event details and settings",content:(0,c.jsx)(A,{event:g.event,orgId:s,onRefresh:I})},{id:"registrations",label:"Registrations",icon:"mdi:clipboard-list-outline",description:"View registrations and form responses",content:(0,c.jsx)(le,{event:g.event,orgId:s,onRefresh:I})},{id:"checkin",label:"Check-In",icon:"mdi:qrcode-scan",description:"Manage event check-in and attendance",content:(0,c.jsx)(ie,{event:g.event,orgId:s,onRefresh:I,isTabActive:"checkin"===y})},{id:"equipment",label:"Equipment",icon:"mdi:package-variant",description:"Manage equipment checkout and tracking",comingSoon:!0,content:(0,c.jsx)(re,{feature:"Equipment"})},{id:"communications",label:"Communications",icon:"mdi:message-text",description:"Message volunteers and attendees",comingSoon:!0,content:(0,c.jsx)(re,{feature:"Communications"})}];return(0,c.jsxs)("div",{ref:E,className:`event-dashboard ${u}`,children:[(0,c.jsx)(m,{event:g.event,stats:g.stats,onClose:d,onRefresh:I,orgId:s,activeTab:y}),(0,c.jsx)("div",{className:"event-dashboard-content",children:(0,c.jsx)(o.ZP,{tabs:R,defaultTab:"overview",activeTab:y,onTabChange:k,tabStyle:"default",size:"medium",animated:!0,showTabIcons:!0,showTabLabels:!0,fullWidth:!1,scrollable:!0,lazyLoad:!0,keepAlive:!0,className:"event-dashboard-tabs"})})]})}}}]);
//# sourceMappingURL=160.4a3a2e8a.chunk.js.map